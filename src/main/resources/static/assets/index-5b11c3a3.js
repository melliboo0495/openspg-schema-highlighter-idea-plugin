var Sc=Object.defineProperty;var Cc=(e,t,n)=>t in e?Sc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var re=(e,t,n)=>(Cc(e,typeof t!="symbol"?t+"":t,n),n);import{r as M,g as ri,R as kc,j as b}from"./index-ed6037d2.js";function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ie(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Mc={value:()=>{}};function Zt(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Lt(n)}function Lt(e){this._=e}function Ic(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Lt.prototype=Zt.prototype={constructor:Lt,on:function(e,t){var n=this._,r=Ic(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=$c(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=Ir(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Ir(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Lt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function $c(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Ir(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Mc,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Rn="http://www.w3.org/1999/xhtml";const $r={svg:"http://www.w3.org/2000/svg",xhtml:Rn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),$r.hasOwnProperty(t)?{space:$r[t],local:e}:e}function Pc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Rn&&t.documentElement.namespaceURI===Rn?t.createElement(e):t.createElementNS(n,e)}}function Oc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function oi(e){var t=Qt(e);return(t.local?Oc:Pc)(t)}function Ac(){}function rr(e){return e==null?Ac:function(){return this.querySelector(e)}}function Tc(e){typeof e!="function"&&(e=rr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),c,l,u=0;u<s;++u)(c=i[u])&&(l=e.call(c,c.__data__,u,i))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new le(r,this._parents)}function Lc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function jc(){return[]}function ii(e){return e==null?jc:function(){return this.querySelectorAll(e)}}function Rc(e){return function(){return Lc(e.apply(this,arguments))}}function Dc(e){typeof e=="function"?e=Rc(e):e=ii(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(r.push(e.call(c,c.__data__,l,s)),o.push(c));return new le(r,o)}function si(e){return function(){return this.matches(e)}}function ai(e){return function(t){return t.matches(e)}}var zc=Array.prototype.find;function Bc(e){return function(){return zc.call(this.children,e)}}function Vc(){return this.firstElementChild}function Hc(e){return this.select(e==null?Vc:Bc(typeof e=="function"?e:ai(e)))}var Fc=Array.prototype.filter;function Yc(){return Array.from(this.children)}function Xc(e){return function(){return Fc.call(this.children,e)}}function Wc(e){return this.selectAll(e==null?Yc:Xc(typeof e=="function"?e:ai(e)))}function Gc(e){typeof e!="function"&&(e=si(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new le(r,this._parents)}function ci(e){return new Array(e.length)}function qc(){return new le(this._enter||this._groups.map(ci),this._parents)}function zt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zt.prototype={constructor:zt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Kc(e){return function(){return e}}function Uc(e,t,n,r,o,i){for(var s=0,a,c=t.length,l=i.length;s<l;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new zt(e,i[s]);for(;s<c;++s)(a=t[s])&&(o[s]=a)}function Zc(e,t,n,r,o,i,s){var a,c,l=new Map,u=t.length,d=i.length,f=new Array(u),h;for(a=0;a<u;++a)(c=t[a])&&(f[a]=h=s.call(c,c.__data__,a,t)+"",l.has(h)?o[a]=c:l.set(h,c));for(a=0;a<d;++a)h=s.call(e,i[a],a,i)+"",(c=l.get(h))?(r[a]=c,c.__data__=i[a],l.delete(h)):n[a]=new zt(e,i[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(o[a]=c)}function Qc(e){return e.__data__}function Jc(e,t){if(!arguments.length)return Array.from(this,Qc);var n=t?Zc:Uc,r=this._parents,o=this._groups;typeof e!="function"&&(e=Kc(e));for(var i=o.length,s=new Array(i),a=new Array(i),c=new Array(i),l=0;l<i;++l){var u=r[l],d=o[l],f=d.length,h=el(e.call(u,u&&u.__data__,l,r)),p=h.length,g=a[l]=new Array(p),v=s[l]=new Array(p),w=c[l]=new Array(f);n(u,d,g,v,w,h,t);for(var _=0,x=0,y,S;_<p;++_)if(y=g[_]){for(_>=x&&(x=_+1);!(S=v[x])&&++x<p;);y._next=S||null}}return s=new le(s,r),s._enter=a,s._exit=c,s}function el(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tl(){return new le(this._exit||this._groups.map(ci),this._parents)}function nl(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function rl(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),c=0;c<s;++c)for(var l=n[c],u=r[c],d=l.length,f=a[c]=new Array(d),h,p=0;p<d;++p)(h=l[p]||u[p])&&(f[p]=h);for(;c<o;++c)a[c]=n[c];return new le(a,this._parents)}function ol(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function il(e){e||(e=sl);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,c=o[i]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new le(o,this._parents).order()}function sl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function al(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function cl(){return Array.from(this)}function ll(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function ul(){let e=0;for(const t of this)++e;return e}function dl(){return!this.node()}function fl(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function hl(e){return function(){this.removeAttribute(e)}}function pl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function gl(e,t){return function(){this.setAttribute(e,t)}}function ml(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function yl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function wl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function xl(e,t){var n=Qt(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?pl:hl:typeof t=="function"?n.local?wl:yl:n.local?ml:gl)(n,t))}function li(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function bl(e){return function(){this.style.removeProperty(e)}}function vl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function El(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function _l(e,t,n){return arguments.length>1?this.each((t==null?bl:typeof t=="function"?El:vl)(e,t,n??"")):Fe(this.node(),e)}function Fe(e,t){return e.style.getPropertyValue(t)||li(e).getComputedStyle(e,null).getPropertyValue(t)}function Nl(e){return function(){delete this[e]}}function Sl(e,t){return function(){this[e]=t}}function Cl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function kl(e,t){return arguments.length>1?this.each((t==null?Nl:typeof t=="function"?Cl:Sl)(e,t)):this.node()[e]}function ui(e){return e.trim().split(/^|\s+/)}function or(e){return e.classList||new di(e)}function di(e){this._node=e,this._names=ui(e.getAttribute("class")||"")}di.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function fi(e,t){for(var n=or(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function hi(e,t){for(var n=or(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Ml(e){return function(){fi(this,e)}}function Il(e){return function(){hi(this,e)}}function $l(e,t){return function(){(t.apply(this,arguments)?fi:hi)(this,e)}}function Pl(e,t){var n=ui(e+"");if(arguments.length<2){for(var r=or(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?$l:t?Ml:Il)(n,t))}function Ol(){this.textContent=""}function Al(e){return function(){this.textContent=e}}function Tl(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Ll(e){return arguments.length?this.each(e==null?Ol:(typeof e=="function"?Tl:Al)(e)):this.node().textContent}function jl(){this.innerHTML=""}function Rl(e){return function(){this.innerHTML=e}}function Dl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function zl(e){return arguments.length?this.each(e==null?jl:(typeof e=="function"?Dl:Rl)(e)):this.node().innerHTML}function Bl(){this.nextSibling&&this.parentNode.appendChild(this)}function Vl(){return this.each(Bl)}function Hl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Fl(){return this.each(Hl)}function Yl(e){var t=typeof e=="function"?e:oi(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Xl(){return null}function Wl(e,t){var n=typeof e=="function"?e:oi(e),r=t==null?Xl:typeof t=="function"?t:rr(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Gl(){var e=this.parentNode;e&&e.removeChild(this)}function ql(){return this.each(Gl)}function Kl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ul(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Zl(e){return this.select(e?Ul:Kl)}function Ql(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Jl(e){return function(t){e.call(this,t,this.__data__)}}function eu(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function tu(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function nu(e,t,n){return function(){var r=this.__on,o,i=Jl(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function ru(e,t,n){var r=eu(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(o=0,u=a[c];o<i;++o)if((s=r[o]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?nu:tu,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function pi(e,t,n){var r=li(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ou(e,t){return function(){return pi(this,e,t)}}function iu(e,t){return function(){return pi(this,e,t.apply(this,arguments))}}function su(e,t){return this.each((typeof t=="function"?iu:ou)(e,t))}function*au(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var gi=[null];function le(e,t){this._groups=e,this._parents=t}function xt(){return new le([[document.documentElement]],gi)}function cu(){return this}le.prototype=xt.prototype={constructor:le,select:Tc,selectAll:Dc,selectChild:Hc,selectChildren:Wc,filter:Gc,data:Jc,enter:qc,exit:tl,join:nl,merge:rl,selection:cu,order:ol,sort:il,call:al,nodes:cl,node:ll,size:ul,empty:dl,each:fl,attr:xl,style:_l,property:kl,classed:Pl,text:Ll,html:zl,raise:Vl,lower:Fl,append:Yl,insert:Wl,remove:ql,clone:Zl,datum:Ql,on:ru,dispatch:su,[Symbol.iterator]:au};function ce(e){return typeof e=="string"?new le([[document.querySelector(e)]],[document.documentElement]):new le([[e]],gi)}function lu(e){let t;for(;t=e.sourceEvent;)e=t;return e}function fe(e,t){if(e=lu(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const uu={passive:!1},lt={capture:!0,passive:!1};function vn(e){e.stopImmediatePropagation()}function Ve(e){e.preventDefault(),e.stopImmediatePropagation()}function mi(e){var t=e.document.documentElement,n=ce(e).on("dragstart.drag",Ve,lt);"onselectstart"in t?n.on("selectstart.drag",Ve,lt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function yi(e,t){var n=e.document.documentElement,r=ce(e).on("dragstart.drag",null);t&&(r.on("click.drag",Ve,lt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const St=e=>()=>e;function Dn(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Dn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function du(e){return!e.ctrlKey&&!e.button}function fu(){return this.parentNode}function hu(e,t){return t??{x:e.x,y:e.y}}function pu(){return navigator.maxTouchPoints||"ontouchstart"in this}function wi(){var e=du,t=fu,n=hu,r=pu,o={},i=Zt("start","drag","end"),s=0,a,c,l,u,d=0;function f(y){y.on("mousedown.drag",h).filter(r).on("touchstart.drag",v).on("touchmove.drag",w,uu).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(y,S){if(!(u||!e.call(this,y,S))){var T=x(this,t.call(this,y,S),y,S,"mouse");T&&(ce(y.view).on("mousemove.drag",p,lt).on("mouseup.drag",g,lt),mi(y.view),vn(y),l=!1,a=y.clientX,c=y.clientY,T("start",y))}}function p(y){if(Ve(y),!l){var S=y.clientX-a,T=y.clientY-c;l=S*S+T*T>d}o.mouse("drag",y)}function g(y){ce(y.view).on("mousemove.drag mouseup.drag",null),yi(y.view,l),Ve(y),o.mouse("end",y)}function v(y,S){if(e.call(this,y,S)){var T=y.changedTouches,N=t.call(this,y,S),A=T.length,P,O;for(P=0;P<A;++P)(O=x(this,N,y,S,T[P].identifier,T[P]))&&(vn(y),O("start",y,T[P]))}}function w(y){var S=y.changedTouches,T=S.length,N,A;for(N=0;N<T;++N)(A=o[S[N].identifier])&&(Ve(y),A("drag",y,S[N]))}function _(y){var S=y.changedTouches,T=S.length,N,A;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),N=0;N<T;++N)(A=o[S[N].identifier])&&(vn(y),A("end",y,S[N]))}function x(y,S,T,N,A,P){var O=i.copy(),D=fe(P||T,S),R,j,m;if((m=n.call(y,new Dn("beforestart",{sourceEvent:T,target:f,identifier:A,active:s,x:D[0],y:D[1],dx:0,dy:0,dispatch:O}),N))!=null)return R=m.x-D[0]||0,j=m.y-D[1]||0,function k(E,$,C){var I=D,L;switch(E){case"start":o[A]=k,L=s++;break;case"end":delete o[A],--s;case"drag":D=fe(C||$,S),L=s;break}O.call(E,y,new Dn(E,{sourceEvent:$,subject:m,target:f,identifier:A,active:L,x:D[0]+R,y:D[1]+j,dx:D[0]-I[0],dy:D[1]-I[1],dispatch:O}),N)}}return f.filter=function(y){return arguments.length?(e=typeof y=="function"?y:St(!!y),f):e},f.container=function(y){return arguments.length?(t=typeof y=="function"?y:St(y),f):t},f.subject=function(y){return arguments.length?(n=typeof y=="function"?y:St(y),f):n},f.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:St(!!y),f):r},f.on=function(){var y=i.on.apply(i,arguments);return y===i?f:y},f.clickDistance=function(y){return arguments.length?(d=(y=+y)*y,f):Math.sqrt(d)},f}function ir(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function xi(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function bt(){}var ut=.7,Bt=1/ut,He="\\s*([+-]?\\d+)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ye="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gu=/^#([0-9a-f]{3,8})$/,mu=new RegExp(`^rgb\\(${He},${He},${He}\\)$`),yu=new RegExp(`^rgb\\(${ye},${ye},${ye}\\)$`),wu=new RegExp(`^rgba\\(${He},${He},${He},${dt}\\)$`),xu=new RegExp(`^rgba\\(${ye},${ye},${ye},${dt}\\)$`),bu=new RegExp(`^hsl\\(${dt},${ye},${ye}\\)$`),vu=new RegExp(`^hsla\\(${dt},${ye},${ye},${dt}\\)$`),Pr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ir(bt,ft,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Or,formatHex:Or,formatHex8:Eu,formatHsl:_u,formatRgb:Ar,toString:Ar});function Or(){return this.rgb().formatHex()}function Eu(){return this.rgb().formatHex8()}function _u(){return bi(this).formatHsl()}function Ar(){return this.rgb().formatRgb()}function ft(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=gu.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Tr(t):n===3?new ae(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ct(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ct(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mu.exec(e))?new ae(t[1],t[2],t[3],1):(t=yu.exec(e))?new ae(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=wu.exec(e))?Ct(t[1],t[2],t[3],t[4]):(t=xu.exec(e))?Ct(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=bu.exec(e))?Rr(t[1],t[2]/100,t[3]/100,1):(t=vu.exec(e))?Rr(t[1],t[2]/100,t[3]/100,t[4]):Pr.hasOwnProperty(e)?Tr(Pr[e]):e==="transparent"?new ae(NaN,NaN,NaN,0):null}function Tr(e){return new ae(e>>16&255,e>>8&255,e&255,1)}function Ct(e,t,n,r){return r<=0&&(e=t=n=NaN),new ae(e,t,n,r)}function Nu(e){return e instanceof bt||(e=ft(e)),e?(e=e.rgb(),new ae(e.r,e.g,e.b,e.opacity)):new ae}function zn(e,t,n,r){return arguments.length===1?Nu(e):new ae(e,t,n,r??1)}function ae(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ir(ae,zn,xi(bt,{brighter(e){return e=e==null?Bt:Math.pow(Bt,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ut:Math.pow(ut,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ae(Te(this.r),Te(this.g),Te(this.b),Vt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Lr,formatHex:Lr,formatHex8:Su,formatRgb:jr,toString:jr}));function Lr(){return`#${Ae(this.r)}${Ae(this.g)}${Ae(this.b)}`}function Su(){return`#${Ae(this.r)}${Ae(this.g)}${Ae(this.b)}${Ae((isNaN(this.opacity)?1:this.opacity)*255)}`}function jr(){const e=Vt(this.opacity);return`${e===1?"rgb(":"rgba("}${Te(this.r)}, ${Te(this.g)}, ${Te(this.b)}${e===1?")":`, ${e})`}`}function Vt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Te(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ae(e){return e=Te(e),(e<16?"0":"")+e.toString(16)}function Rr(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new he(e,t,n,r)}function bi(e){if(e instanceof he)return new he(e.h,e.s,e.l,e.opacity);if(e instanceof bt||(e=ft(e)),!e)return new he;if(e instanceof he)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,c=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=c<.5?i+o:2-i-o,s*=60):a=c>0&&c<1?0:s,new he(s,a,c,e.opacity)}function Cu(e,t,n,r){return arguments.length===1?bi(e):new he(e,t,n,r??1)}function he(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ir(he,Cu,xi(bt,{brighter(e){return e=e==null?Bt:Math.pow(Bt,e),new he(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ut:Math.pow(ut,e),new he(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new ae(En(e>=240?e-240:e+120,o,r),En(e,o,r),En(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new he(Dr(this.h),kt(this.s),kt(this.l),Vt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Vt(this.opacity);return`${e===1?"hsl(":"hsla("}${Dr(this.h)}, ${kt(this.s)*100}%, ${kt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Dr(e){return e=(e||0)%360,e<0?e+360:e}function kt(e){return Math.max(0,Math.min(1,e||0))}function En(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const vi=e=>()=>e;function ku(e,t){return function(n){return e+n*t}}function Mu(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Iu(e){return(e=+e)==1?Ei:function(t,n){return n-t?Mu(t,n,e):vi(isNaN(t)?n:t)}}function Ei(e,t){var n=t-e;return n?ku(e,n):vi(isNaN(e)?t:e)}const zr=function e(t){var n=Iu(t);function r(o,i){var s=n((o=zn(o)).r,(i=zn(i)).r),a=n(o.g,i.g),c=n(o.b,i.b),l=Ei(o.opacity,i.opacity);return function(u){return o.r=s(u),o.g=a(u),o.b=c(u),o.opacity=l(u),o+""}}return r.gamma=e,r}(1);function Ie(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Bn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_n=new RegExp(Bn.source,"g");function $u(e){return function(){return e}}function Pu(e){return function(t){return e(t)+""}}function Ou(e,t){var n=Bn.lastIndex=_n.lastIndex=0,r,o,i,s=-1,a=[],c=[];for(e=e+"",t=t+"";(r=Bn.exec(e))&&(o=_n.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,c.push({i:s,x:Ie(r,o)})),n=_n.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?Pu(c[0].x):$u(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)a[(d=c[u]).i]=d.x(l);return a.join("")})}var Br=180/Math.PI,Vn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _i(e,t,n,r,o,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Br,skewX:Math.atan(c)*Br,scaleX:s,scaleY:a}}var Mt;function Au(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Vn:_i(t.a,t.b,t.c,t.d,t.e,t.f)}function Tu(e){return e==null||(Mt||(Mt=document.createElementNS("http://www.w3.org/2000/svg","g")),Mt.setAttribute("transform",e),!(e=Mt.transform.baseVal.consolidate()))?Vn:(e=e.matrix,_i(e.a,e.b,e.c,e.d,e.e,e.f))}function Ni(e,t,n,r){function o(l){return l.length?l.pop()+" ":""}function i(l,u,d,f,h,p){if(l!==d||u!==f){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:Ie(l,d)},{i:g-2,x:Ie(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function s(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(o(d)+"rotate(",null,r)-2,x:Ie(l,u)})):u&&d.push(o(d)+"rotate("+u+r)}function a(l,u,d,f){l!==u?f.push({i:d.push(o(d)+"skewX(",null,r)-2,x:Ie(l,u)}):u&&d.push(o(d)+"skewX("+u+r)}function c(l,u,d,f,h,p){if(l!==d||u!==f){var g=h.push(o(h)+"scale(",null,",",null,")");p.push({i:g-4,x:Ie(l,d)},{i:g-2,x:Ie(u,f)})}else(d!==1||f!==1)&&h.push(o(h)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),i(l.translateX,l.translateY,u.translateX,u.translateY,d,f),s(l.rotate,u.rotate,d,f),a(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(h){for(var p=-1,g=f.length,v;++p<g;)d[(v=f[p]).i]=v.x(h);return d.join("")}}}var Lu=Ni(Au,"px, ","px)","deg)"),ju=Ni(Tu,", ",")",")"),Ru=1e-12;function Vr(e){return((e=Math.exp(e))+1/e)/2}function Du(e){return((e=Math.exp(e))-1/e)/2}function zu(e){return((e=Math.exp(2*e))-1)/(e+1)}const Bu=function e(t,n,r){function o(i,s){var a=i[0],c=i[1],l=i[2],u=s[0],d=s[1],f=s[2],h=u-a,p=d-c,g=h*h+p*p,v,w;if(g<Ru)w=Math.log(f/l)/t,v=function(N){return[a+N*h,c+N*p,l*Math.exp(t*N*w)]};else{var _=Math.sqrt(g),x=(f*f-l*l+r*g)/(2*l*n*_),y=(f*f-l*l-r*g)/(2*f*n*_),S=Math.log(Math.sqrt(x*x+1)-x),T=Math.log(Math.sqrt(y*y+1)-y);w=(T-S)/t,v=function(N){var A=N*w,P=Vr(S),O=l/(n*_)*(P*zu(t*A+S)-Du(S));return[a+O*h,c+O*p,l*P/Vr(t*A+S)]}}return v.duration=w*1e3*t/Math.SQRT2,v}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},o}(Math.SQRT2,2,4);var Ye=0,ot=0,nt=0,Si=1e3,Ht,it,Ft=0,je=0,Jt=0,ht=typeof performance=="object"&&performance.now?performance:Date,Ci=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function sr(){return je||(Ci(Vu),je=ht.now()+Jt)}function Vu(){je=0}function Yt(){this._call=this._time=this._next=null}Yt.prototype=ki.prototype={constructor:Yt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?sr():+n)+(t==null?0:+t),!this._next&&it!==this&&(it?it._next=this:Ht=this,it=this),this._call=e,this._time=n,Hn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Hn())}};function ki(e,t,n){var r=new Yt;return r.restart(e,t,n),r}function Hu(){sr(),++Ye;for(var e=Ht,t;e;)(t=je-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ye}function Hr(){je=(Ft=ht.now())+Jt,Ye=ot=0;try{Hu()}finally{Ye=0,Yu(),je=0}}function Fu(){var e=ht.now(),t=e-Ft;t>Si&&(Jt-=t,Ft=e)}function Yu(){for(var e,t=Ht,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Ht=n);it=e,Hn(r)}function Hn(e){if(!Ye){ot&&(ot=clearTimeout(ot));var t=e-je;t>24?(e<1/0&&(ot=setTimeout(Hr,e-ht.now()-Jt)),nt&&(nt=clearInterval(nt))):(nt||(Ft=ht.now(),nt=setInterval(Fu,Si)),Ye=1,Ci(Hr))}}function Fr(e,t,n){var r=new Yt;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Xu=Zt("start","end","cancel","interrupt"),Wu=[],Mi=0,Yr=1,Fn=2,jt=3,Xr=4,Yn=5,Rt=6;function en(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Gu(e,n,{name:t,index:r,group:o,on:Xu,tween:Wu,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Mi})}function ar(e,t){var n=ge(e,t);if(n.state>Mi)throw new Error("too late; already scheduled");return n}function we(e,t){var n=ge(e,t);if(n.state>jt)throw new Error("too late; already running");return n}function ge(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Gu(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=ki(i,0,n.time);function i(l){n.state=Yr,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var u,d,f,h;if(n.state!==Yr)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===jt)return Fr(s);h.state===Xr?(h.state=Rt,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Rt,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(Fr(function(){n.state===jt&&(n.state=Xr,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=Fn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Fn){for(n.state=jt,o=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=h);o.length=d+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Yn,1),d=-1,f=o.length;++d<f;)o[d].call(e,u);n.state===Yn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Rt,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Dt(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>Fn&&r.state<Yn,r.state=Rt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function qu(e){return this.each(function(){Dt(this,e)})}function Ku(e,t){var n,r;return function(){var o=we(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Uu(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=we(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=a;break}c===l&&o.push(a)}i.tween=o}}function Zu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ge(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Ku:Uu)(n,e,t))}function cr(e,t,n){var r=e._id;return e.each(function(){var o=we(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return ge(o,r).value[t]}}function Ii(e,t){var n;return(typeof t=="number"?Ie:t instanceof ft?zr:(n=ft(t))?(t=n,zr):Ou)(e,t)}function Qu(e){return function(){this.removeAttribute(e)}}function Ju(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ed(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function td(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function nd(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function rd(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function od(e,t){var n=Qt(e),r=n==="transform"?ju:Ii;return this.attrTween(e,typeof t=="function"?(n.local?rd:nd)(n,r,cr(this,"attr."+e,t)):t==null?(n.local?Ju:Qu)(n):(n.local?td:ed)(n,r,t))}function id(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function sd(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ad(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&sd(e,i)),n}return o._value=t,o}function cd(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&id(e,i)),n}return o._value=t,o}function ld(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Qt(e);return this.tween(n,(r.local?ad:cd)(r,t))}function ud(e,t){return function(){ar(this,e).delay=+t.apply(this,arguments)}}function dd(e,t){return t=+t,function(){ar(this,e).delay=t}}function fd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ud:dd)(t,e)):ge(this.node(),t).delay}function hd(e,t){return function(){we(this,e).duration=+t.apply(this,arguments)}}function pd(e,t){return t=+t,function(){we(this,e).duration=t}}function gd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hd:pd)(t,e)):ge(this.node(),t).duration}function md(e,t){if(typeof t!="function")throw new Error;return function(){we(this,e).ease=t}}function yd(e){var t=this._id;return arguments.length?this.each(md(t,e)):ge(this.node(),t).ease}function wd(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;we(this,e).ease=n}}function xd(e){if(typeof e!="function")throw new Error;return this.each(wd(this._id,e))}function bd(e){typeof e!="function"&&(e=si(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new Ne(r,this._parents,this._name,this._id)}function vd(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var c=t[a],l=n[a],u=c.length,d=s[a]=new Array(u),f,h=0;h<u;++h)(f=c[h]||l[h])&&(d[h]=f);for(;a<r;++a)s[a]=t[a];return new Ne(s,this._parents,this._name,this._id)}function Ed(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function _d(e,t,n){var r,o,i=Ed(t)?ar:we;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function Nd(e,t){var n=this._id;return arguments.length<2?ge(this.node(),n).on.on(e):this.each(_d(n,e,t))}function Sd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Cd(){return this.on("end.remove",Sd(this._id))}function kd(e){var t=this._name,n=this._id;typeof e!="function"&&(e=rr(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],c=a.length,l=i[s]=new Array(c),u,d,f=0;f<c;++f)(u=a[f])&&(d=e.call(u,u.__data__,f,a))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,en(l[f],t,n,f,l,ge(u,n)));return new Ne(i,this._parents,t,n)}function Md(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ii(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var c=r[a],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),h,p=ge(u,n),g=0,v=f.length;g<v;++g)(h=f[g])&&en(h,t,n,g,f,p);i.push(f),s.push(u)}return new Ne(i,s,t,n)}var Id=xt.prototype.constructor;function $d(){return new Id(this._groups,this._parents)}function Pd(e,t){var n,r,o;return function(){var i=Fe(this,e),s=(this.style.removeProperty(e),Fe(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function $i(e){return function(){this.style.removeProperty(e)}}function Od(e,t,n){var r,o=n+"",i;return function(){var s=Fe(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function Ad(e,t,n){var r,o,i;return function(){var s=Fe(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Fe(this,e))),s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a))}}function Td(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var c=we(this,e),l=c.on,u=c.value[i]==null?a||(a=$i(t)):void 0;(l!==n||o!==u)&&(r=(n=l).copy()).on(s,o=u),c.on=r}}function Ld(e,t,n){var r=(e+="")=="transform"?Lu:Ii;return t==null?this.styleTween(e,Pd(e,r)).on("end.style."+e,$i(e)):typeof t=="function"?this.styleTween(e,Ad(e,r,cr(this,"style."+e,t))).each(Td(this._id,e)):this.styleTween(e,Od(e,r,t),n).on("end.style."+e,null)}function jd(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Rd(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&jd(e,s,n)),r}return i._value=t,i}function Dd(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Rd(e,t,n??""))}function zd(e){return function(){this.textContent=e}}function Bd(e){return function(){var t=e(this);this.textContent=t??""}}function Vd(e){return this.tween("text",typeof e=="function"?Bd(cr(this,"text",e)):zd(e==null?"":e+""))}function Hd(e){return function(t){this.textContent=e.call(this,t)}}function Fd(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Hd(o)),t}return r._value=e,r}function Yd(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Fd(e))}function Xd(){for(var e=this._name,t=this._id,n=Pi(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=ge(c,t);en(c,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ne(r,this._parents,e,n)}function Wd(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--o===0&&i()}};n.each(function(){var l=we(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),o===0&&i()})}var Gd=0;function Ne(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Pi(){return++Gd}var xe=xt.prototype;Ne.prototype={constructor:Ne,select:kd,selectAll:Md,selectChild:xe.selectChild,selectChildren:xe.selectChildren,filter:bd,merge:vd,selection:$d,transition:Xd,call:xe.call,nodes:xe.nodes,node:xe.node,size:xe.size,empty:xe.empty,each:xe.each,on:Nd,attr:od,attrTween:ld,style:Ld,styleTween:Dd,text:Vd,textTween:Yd,remove:Cd,tween:Zu,delay:fd,duration:gd,ease:yd,easeVarying:xd,end:Wd,[Symbol.iterator]:xe[Symbol.iterator]};function qd(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Kd={time:null,delay:0,duration:250,ease:qd};function Ud(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Zd(e){var t,n;e instanceof Ne?(t=e._id,e=e._name):(t=Pi(),(n=Kd).time=sr(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&en(c,e,t,l,s,n||Ud(c,t));return new Ne(r,this._parents,e,t)}xt.prototype.interrupt=qu;xt.prototype.transition=Zd;const It=e=>()=>e;function Qd(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ee(e,t,n){this.k=e,this.x=t,this.y=n}Ee.prototype={constructor:Ee,scale:function(e){return e===1?this:new Ee(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ee(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tn=new Ee(1,0,0);Oi.prototype=Ee.prototype;function Oi(e){for(;!e.__zoom;)if(!(e=e.parentNode))return tn;return e.__zoom}function Nn(e){e.stopImmediatePropagation()}function rt(e){e.preventDefault(),e.stopImmediatePropagation()}function Jd(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function ef(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Wr(){return this.__zoom||tn}function tf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function nf(){return navigator.maxTouchPoints||"ontouchstart"in this}function rf(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Ai(){var e=Jd,t=ef,n=rf,r=tf,o=nf,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Bu,l=Zt("start","zoom","end"),u,d,f,h=500,p=150,g=0,v=10;function w(m){m.property("__zoom",Wr).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",O).filter(o).on("touchstart.zoom",D).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(m,k,E,$){var C=m.selection?m.selection():m;C.property("__zoom",Wr),m!==C?S(m,k,E,$):C.interrupt().each(function(){T(this,arguments).event($).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},w.scaleBy=function(m,k,E,$){w.scaleTo(m,function(){var C=this.__zoom.k,I=typeof k=="function"?k.apply(this,arguments):k;return C*I},E,$)},w.scaleTo=function(m,k,E,$){w.transform(m,function(){var C=t.apply(this,arguments),I=this.__zoom,L=E==null?y(C):typeof E=="function"?E.apply(this,arguments):E,z=I.invert(L),B=typeof k=="function"?k.apply(this,arguments):k;return n(x(_(I,B),L,z),C,s)},E,$)},w.translateBy=function(m,k,E,$){w.transform(m,function(){return n(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof E=="function"?E.apply(this,arguments):E),t.apply(this,arguments),s)},null,$)},w.translateTo=function(m,k,E,$,C){w.transform(m,function(){var I=t.apply(this,arguments),L=this.__zoom,z=$==null?y(I):typeof $=="function"?$.apply(this,arguments):$;return n(tn.translate(z[0],z[1]).scale(L.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof E=="function"?-E.apply(this,arguments):-E),I,s)},$,C)};function _(m,k){return k=Math.max(i[0],Math.min(i[1],k)),k===m.k?m:new Ee(k,m.x,m.y)}function x(m,k,E){var $=k[0]-E[0]*m.k,C=k[1]-E[1]*m.k;return $===m.x&&C===m.y?m:new Ee(m.k,$,C)}function y(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function S(m,k,E,$){m.on("start.zoom",function(){T(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event($).end()}).tween("zoom",function(){var C=this,I=arguments,L=T(C,I).event($),z=t.apply(C,I),B=E==null?y(z):typeof E=="function"?E.apply(C,I):E,W=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),H=C.__zoom,Y=typeof k=="function"?k.apply(C,I):k,X=c(H.invert(B).concat(W/H.k),Y.invert(B).concat(W/Y.k));return function(q){if(q===1)q=Y;else{var V=X(q),K=W/V[2];q=new Ee(K,B[0]-V[0]*K,B[1]-V[1]*K)}L.zoom(null,q)}})}function T(m,k,E){return!E&&m.__zooming||new N(m,k)}function N(m,k){this.that=m,this.args=k,this.active=0,this.sourceEvent=null,this.extent=t.apply(m,k),this.taps=0}N.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,k){return this.mouse&&m!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var k=ce(this.that).datum();l.call(m,this.that,new Qd(m,{sourceEvent:this.sourceEvent,target:w,type:m,transform:this.that.__zoom,dispatch:l}),k)}};function A(m,...k){if(!e.apply(this,arguments))return;var E=T(this,k).event(m),$=this.__zoom,C=Math.max(i[0],Math.min(i[1],$.k*Math.pow(2,r.apply(this,arguments)))),I=fe(m);if(E.wheel)(E.mouse[0][0]!==I[0]||E.mouse[0][1]!==I[1])&&(E.mouse[1]=$.invert(E.mouse[0]=I)),clearTimeout(E.wheel);else{if($.k===C)return;E.mouse=[I,$.invert(I)],Dt(this),E.start()}rt(m),E.wheel=setTimeout(L,p),E.zoom("mouse",n(x(_($,C),E.mouse[0],E.mouse[1]),E.extent,s));function L(){E.wheel=null,E.end()}}function P(m,...k){if(f||!e.apply(this,arguments))return;var E=m.currentTarget,$=T(this,k,!0).event(m),C=ce(m.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",W,!0),I=fe(m,E),L=m.clientX,z=m.clientY;mi(m.view),Nn(m),$.mouse=[I,this.__zoom.invert(I)],Dt(this),$.start();function B(H){if(rt(H),!$.moved){var Y=H.clientX-L,X=H.clientY-z;$.moved=Y*Y+X*X>g}$.event(H).zoom("mouse",n(x($.that.__zoom,$.mouse[0]=fe(H,E),$.mouse[1]),$.extent,s))}function W(H){C.on("mousemove.zoom mouseup.zoom",null),yi(H.view,$.moved),rt(H),$.event(H).end()}}function O(m,...k){if(e.apply(this,arguments)){var E=this.__zoom,$=fe(m.changedTouches?m.changedTouches[0]:m,this),C=E.invert($),I=E.k*(m.shiftKey?.5:2),L=n(x(_(E,I),$,C),t.apply(this,k),s);rt(m),a>0?ce(this).transition().duration(a).call(S,L,$,m):ce(this).call(w.transform,L,$,m)}}function D(m,...k){if(e.apply(this,arguments)){var E=m.touches,$=E.length,C=T(this,k,m.changedTouches.length===$).event(m),I,L,z,B;for(Nn(m),L=0;L<$;++L)z=E[L],B=fe(z,this),B=[B,this.__zoom.invert(B),z.identifier],C.touch0?!C.touch1&&C.touch0[2]!==B[2]&&(C.touch1=B,C.taps=0):(C.touch0=B,I=!0,C.taps=1+!!u);u&&(u=clearTimeout(u)),I&&(C.taps<2&&(d=B[0],u=setTimeout(function(){u=null},h)),Dt(this),C.start())}}function R(m,...k){if(this.__zooming){var E=T(this,k).event(m),$=m.changedTouches,C=$.length,I,L,z,B;for(rt(m),I=0;I<C;++I)L=$[I],z=fe(L,this),E.touch0&&E.touch0[2]===L.identifier?E.touch0[0]=z:E.touch1&&E.touch1[2]===L.identifier&&(E.touch1[0]=z);if(L=E.that.__zoom,E.touch1){var W=E.touch0[0],H=E.touch0[1],Y=E.touch1[0],X=E.touch1[1],q=(q=Y[0]-W[0])*q+(q=Y[1]-W[1])*q,V=(V=X[0]-H[0])*V+(V=X[1]-H[1])*V;L=_(L,Math.sqrt(q/V)),z=[(W[0]+Y[0])/2,(W[1]+Y[1])/2],B=[(H[0]+X[0])/2,(H[1]+X[1])/2]}else if(E.touch0)z=E.touch0[0],B=E.touch0[1];else return;E.zoom("touch",n(x(L,z,B),E.extent,s))}}function j(m,...k){if(this.__zooming){var E=T(this,k).event(m),$=m.changedTouches,C=$.length,I,L;for(Nn(m),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),I=0;I<C;++I)L=$[I],E.touch0&&E.touch0[2]===L.identifier?delete E.touch0:E.touch1&&E.touch1[2]===L.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&(L=fe(L,this),Math.hypot(d[0]-L[0],d[1]-L[1])<v)){var z=ce(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return w.wheelDelta=function(m){return arguments.length?(r=typeof m=="function"?m:It(+m),w):r},w.filter=function(m){return arguments.length?(e=typeof m=="function"?m:It(!!m),w):e},w.touchable=function(m){return arguments.length?(o=typeof m=="function"?m:It(!!m),w):o},w.extent=function(m){return arguments.length?(t=typeof m=="function"?m:It([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),w):t},w.scaleExtent=function(m){return arguments.length?(i[0]=+m[0],i[1]=+m[1],w):[i[0],i[1]]},w.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],w):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},w.constrain=function(m){return arguments.length?(n=m,w):n},w.duration=function(m){return arguments.length?(a=+m,w):a},w.interpolate=function(m){return arguments.length?(c=m,w):c},w.on=function(){var m=l.on.apply(l,arguments);return m===l?w:m},w.clickDistance=function(m){return arguments.length?(g=(m=+m)*m,w):Math.sqrt(g)},w.tapDistance=function(m){return arguments.length?(v=+m,w):v},w}const Se={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID."},pt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Ti=["Enter"," ","Escape"];var Xe;(function(e){e.Strict="strict",e.Loose="loose"})(Xe||(Xe={}));var Le;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Le||(Le={}));var gt;(function(e){e.Partial="partial",e.Full="full"})(gt||(gt={}));const Li={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var be;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(be||(be={}));var Xt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Xt||(Xt={}));var F;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(F||(F={}));const Gr={[F.Left]:F.Right,[F.Right]:F.Left,[F.Top]:F.Bottom,[F.Bottom]:F.Top};function ji(e){return e===null?null:e?"valid":"invalid"}const Ri=e=>"id"in e&&"source"in e&&"target"in e,of=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),lr=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),vt=(e,t=[0,0])=>{const{width:n,height:r}=Ce(e),o=e.origin??t,i=n*o[0],s=r*o[1];return{x:e.position.x-i,y:e.position.y-s}},sf=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const i=typeof o=="string";let s=!t.nodeLookup&&!i?o:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(o):lr(o)?o:t.nodeLookup.get(o.id));const a=s?Wt(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return nn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return rn(n)},Et=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=Wt(r);n=nn(n,o)}}),rn(n)},Di=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1)=>{const a={..._t(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(s&&!d||f)continue;const h=u.width??l.width??l.initialWidth??null,p=u.height??l.height??l.initialHeight??null,g=mt(a,Ge(l)),v=(h??0)*(p??0),w=i&&g>0;(!l.internals.handleBounds||w||g>=v||l.dragging)&&c.push(l)}return c},af=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Xn(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function Wn({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i},s){if(e.size===0)return Promise.resolve(!1);const a=Et(e),c=ur(a,t,n,(s==null?void 0:s.minZoom)??o,(s==null?void 0:s.maxZoom)??i,(s==null?void 0:s.padding)??.1);return await r.setViewport(c,{duration:s==null?void 0:s.duration}),Promise.resolve(!0)}function zi({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},u=s.origin??r;let d=o;if(s.extent==="parent"&&!s.expandParent)if(!a)i==null||i("005",Se.error005());else{const h=a.measured.width,p=a.measured.height;h&&p&&(d=[[c,l],[c+h,l+p]])}else a&&qe(s.extent)&&(d=[[s.extent[0][0]+c,s.extent[0][1]+l],[s.extent[1][0]+c,s.extent[1][1]+l]]);const f=qe(d)?Re(t,d,s.measured):t;return{position:{x:f.x-c+s.measured.width*u[0],y:f.y-l+s.measured.height*u[1]},positionAbsolute:f}}async function cf({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const i=new Set(e.map(f=>f.id)),s=[];for(const f of n){if(f.deletable===!1)continue;const h=i.has(f.id),p=!h&&f.parentId&&s.find(g=>g.id===f.parentId);(h||p)&&s.push(f)}const a=new Set(t.map(f=>f.id)),c=r.filter(f=>f.deletable!==!1),u=af(s,c);for(const f of c)a.has(f.id)&&!u.find(p=>p.id===f.id)&&u.push(f);if(!o)return{edges:u,nodes:s};const d=await o({nodes:s,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:s}:{edges:[],nodes:[]}:d}const We=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Re=(e={x:0,y:0},t,n)=>({x:We(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:We(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Bi(e,t,n){const{width:r,height:o}=Ce(n),{x:i,y:s}=n.internals.positionAbsolute;return Re(e,[[i,s],[i+r,s+o]],t)}const qr=(e,t,n)=>e<t?We(Math.abs(e-t),1,t)/t:e>n?-We(Math.abs(e-n),1,t)/t:0,Vi=(e,t,n=15,r=40)=>{const o=qr(e.x,r,t.width-r)*n,i=qr(e.y,r,t.height-r)*n;return[o,i]},nn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Gn=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),rn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Ge=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=lr(e)?e.internals.positionAbsolute:vt(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0}},Wt=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=lr(e)?e.internals.positionAbsolute:vt(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0)}},Hi=(e,t)=>rn(nn(Gn(e),Gn(t))),mt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Kr=e=>pe(e.width)&&pe(e.height)&&pe(e.x)&&pe(e.y),pe=e=>!isNaN(e)&&isFinite(e),lf=(e,t)=>{},on=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),_t=({x:e,y:t},[n,r,o],i=!1,s=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return i?on(a,s):a},Fi=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),ur=(e,t,n,r,o,i)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(s,a),l=We(c,r,o),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,h=n/2-d*l;return{x:f,y:h,zoom:l}},Gt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function qe(e){return e!==void 0&&e!=="parent"}function Ce(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Yi(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Xi(e,t={width:0,height:0},n,r,o){const i={...e},s=r.get(n);if(s){const a=s.origin||o;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function Ur(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function at(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:i,y:s}=_e(e),a=_t({x:i-((o==null?void 0:o.left)??0),y:s-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?on(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const sn=e=>({width:e.offsetWidth,height:e.offsetHeight}),Wi=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},uf=["INPUT","SELECT","TEXTAREA"];function qn(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:uf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Gi=e=>"clientX"in e,_e=(e,t)=>{var i,s;const n=Gi(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},Zr=(e,t,n,r,o)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:o,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...sn(s)}})};function qi({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+o*.375+s*.375+n*.125,l=t*.125+i*.375+a*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function $t(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Qr({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case F.Left:return[t-$t(t-r,i),n];case F.Right:return[t+$t(r-t,i),n];case F.Top:return[t,n-$t(n-o,i)];case F.Bottom:return[t,n+$t(o-n,i)]}}function dr({sourceX:e,sourceY:t,sourcePosition:n=F.Bottom,targetX:r,targetY:o,targetPosition:i=F.Top,curvature:s=.25}){const[a,c]=Qr({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[l,u]=Qr({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[d,f,h,p]=qi({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${r},${o}`,d,f,h,p]}function Ki({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function df({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const i=n||t.selected||e.selected,s=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(i?s:0)}function ff({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const i=nn(Wt(e),Wt(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return mt(s,rn(i))>0}const hf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,pf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),gf=(e,t)=>{if(!e.source||!e.target)return t;let n;return Ri(e)?n={...e}:n={...e,id:hf(e)},pf(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Ui({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=Ki({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const Jr={[F.Left]:{x:-1,y:0},[F.Right]:{x:1,y:0},[F.Top]:{x:0,y:-1},[F.Bottom]:{x:0,y:1}},mf=({source:e,sourcePosition:t=F.Bottom,target:n})=>t===F.Left||t===F.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},eo=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function yf({source:e,sourcePosition:t=F.Bottom,target:n,targetPosition:r=F.Top,center:o,offset:i}){const s=Jr[t],a=Jr[r],c={x:e.x+s.x*i,y:e.y+s.y*i},l={x:n.x+a.x*i,y:n.y+a.y*i},u=mf({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let h=[],p,g;const v={x:0,y:0},w={x:0,y:0},[_,x,y,S]=Ki({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[d]*a[d]===-1){p=o.x??_,g=o.y??x;const N=[{x:p,y:c.y},{x:p,y:l.y}],A=[{x:c.x,y:g},{x:l.x,y:g}];s[d]===f?h=d==="x"?N:A:h=d==="x"?A:N}else{const N=[{x:c.x,y:l.y}],A=[{x:l.x,y:c.y}];if(d==="x"?h=s.x===f?A:N:h=s.y===f?N:A,t===r){const j=Math.abs(e[d]-n[d]);if(j<=i){const m=Math.min(i-1,i-j);s[d]===f?v[d]=(c[d]>e[d]?-1:1)*m:w[d]=(l[d]>n[d]?-1:1)*m}}if(t!==r){const j=d==="x"?"y":"x",m=s[d]===a[j],k=c[j]>l[j],E=c[j]<l[j];(s[d]===1&&(!m&&k||m&&E)||s[d]!==1&&(!m&&E||m&&k))&&(h=d==="x"?N:A)}const P={x:c.x+v.x,y:c.y+v.y},O={x:l.x+w.x,y:l.y+w.y},D=Math.max(Math.abs(P.x-h[0].x),Math.abs(O.x-h[0].x)),R=Math.max(Math.abs(P.y-h[0].y),Math.abs(O.y-h[0].y));D>=R?(p=(P.x+O.x)/2,g=h[0].y):(p=h[0].x,g=(P.y+O.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...h,{x:l.x+w.x,y:l.y+w.y},n],p,g,y,S]}function wf(e,t,n,r){const o=Math.min(eo(e,t)/2,eo(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+o*l},${s}Q ${i},${s} ${i},${s+o*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+o*c}Q ${i},${s} ${i+o*a},${s}`}function Kn({sourceX:e,sourceY:t,sourcePosition:n=F.Bottom,targetX:r,targetY:o,targetPosition:i=F.Top,borderRadius:s=5,centerX:a,centerY:c,offset:l=20}){const[u,d,f,h,p]=yf({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:c},offset:l});return[u.reduce((v,w,_)=>{let x="";return _>0&&_<u.length-1?x=wf(u[_-1],w,u[_+1],s):x=`${_===0?"M":"L"}${w.x} ${w.y}`,v+=x,v},""),d,f,h,p]}function to(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function xf(e){var d;const{sourceNode:t,targetNode:n}=e;if(!to(t)||!to(n))return null;const r=t.internals.handleBounds||no(t.handles),o=n.internals.handleBounds||no(n.handles),i=ro((r==null?void 0:r.source)??[],e.sourceHandle),s=ro(e.connectionMode===Xe.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!i||!s)return(d=e.onError)==null||d.call(e,"008",Se.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(i==null?void 0:i.position)||F.Bottom,c=(s==null?void 0:s.position)||F.Top,l=yt(t,i,a),u=yt(n,s,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function no(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function yt(e,t,n=F.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,i=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??Ce(e);if(r)return{x:o+s/2,y:i+a/2};switch((t==null?void 0:t.position)??n){case F.Top:return{x:o+s/2,y:i};case F.Right:return{x:o+s,y:i+a/2};case F.Bottom:return{x:o+s/2,y:i+a};case F.Left:return{x:o,y:i+a/2}}}function ro(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Un(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function bf(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||r,a.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=Un(c,t);i.has(l)||(s.push({id:l,color:c.color||n,...c}),i.add(l))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const fr={nodeOrigin:[0,0],nodeExtent:pt,elevateNodesOnSelect:!0,defaults:{}},vf={...fr,checkEquality:!0};function hr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Ef(e,t,n){const r=hr(fr,n);for(const o of e.values())if(o.parentId)pr(o,e,t,r);else{const i=vt(o,r.nodeOrigin),s=qe(o.extent)?o.extent:r.nodeExtent,a=Re(i,s,Ce(o));o.internals.positionAbsolute=a}}function Zn(e,t,n,r){var a,c;const o=hr(vf,r),i=new Map(t),s=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=i.get(l.id);if(o.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=vt(l,o.nodeOrigin),f=qe(l.extent)?l.extent:o.nodeExtent,h=Re(d,f,Ce(l));u={...o.defaults,...l,measured:{width:(a=l.measured)==null?void 0:a.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:h,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:Zi(l,s),userNode:l}},t.set(l.id,u)}l.parentId&&pr(u,t,n,r)}}function _f(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function pr(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:i,nodeExtent:s}=hr(fr,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}_f(e,n);const l=o?1e3:0,{x:u,y:d,z:f}=Nf(e,c,i,s,l),{positionAbsolute:h}=e.internals,p=u!==h.x||d!==h.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:u,y:d}:h,z:f}})}function Zi(e,t){return(pe(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Nf(e,t,n,r,o){const{x:i,y:s}=t.internals.positionAbsolute,a=Ce(e),c=vt(e,n),l=qe(e.extent)?Re(c,e.extent,a):c;let u=Re({x:i+l.x,y:s+l.y},r,a);e.extent==="parent"&&(u=Bi(u,a,t));const d=Zi(e,o),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function gr(e,t,n,r=[0,0]){var s;const o=[],i=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const l=((s=i.get(a.parentId))==null?void 0:s.expandedRect)??Ge(c),u=Hi(l,a.rect);i.set(a.parentId,{expandedRect:u,parent:c})}return i.size>0&&i.forEach(({expandedRect:a,parent:c},l)=>{var x;const u=c.internals.positionAbsolute,d=Ce(c),f=c.origin??r,h=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,p=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,g=Math.max(d.width,Math.round(a.width)),v=Math.max(d.height,Math.round(a.height)),w=(g-d.width)*f[0],_=(v-d.height)*f[1];(h>0||p>0||w||_)&&(o.push({id:l,type:"position",position:{x:c.position.x-h+w,y:c.position.y-p+_}}),(x=n.get(l))==null||x.forEach(y=>{e.some(S=>S.id===y.id)||o.push({id:y.id,type:"position",position:{x:y.position.x+h,y:y.position.y+p}})})),(d.width<a.width||d.height<a.height||h||p)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:g+(h?f[0]*h-w:0),height:v+(p?f[1]*p-_:0)}})}),o}function Sf(e,t,n,r,o,i){const s=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!s)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(s),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const p=sn(f.nodeElement),g=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(g||!h.internals.handleBounds||f.force))){const w=f.nodeElement.getBoundingClientRect(),_=qe(h.extent)?h.extent:i;let{positionAbsolute:x}=h.internals;h.parentId&&h.extent==="parent"?x=Bi(x,p,t.get(h.parentId)):_&&(x=Re(x,_,p));const y={...h,measured:p,internals:{...h.internals,positionAbsolute:x,handleBounds:{source:Zr("source",f.nodeElement,w,u,h.id),target:Zr("target",f.nodeElement,w,u,h.id)}}};t.set(h.id,y),h.parentId&&pr(y,t,n,{nodeOrigin:o}),a=!0,g&&(c.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&d.push({id:h.id,parentId:h.parentId,rect:Ge(y,o)}))}}if(d.length>0){const f=gr(d,t,n,o);c.push(...f)}return{changes:c,updatedInternals:a}}async function Cf({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function oo(e,t,n,r,o,i){let s=o;const a=r.get(s)||new Map;r.set(s,a.set(n,t)),s=`${o}-${e}`;const c=r.get(s)||new Map;if(r.set(s,c.set(n,t)),i){s=`${o}-${e}-${i}`;const l=r.get(s)||new Map;r.set(s,l.set(n,t))}}function Qi(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:i,sourceHandle:s=null,targetHandle:a=null}=r,c={edgeId:r.id,source:o,target:i,sourceHandle:s,targetHandle:a},l=`${o}-${s}--${i}-${a}`,u=`${i}-${a}--${o}-${s}`;oo("source",c,u,e,o,s),oo("target",c,l,e,i,a),t.set(r.id,r)}}function Ji(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:Ji(n,t):!1}function io(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function kf(e,t,n,r){const o=new Map;for(const[i,s]of e)if((s.selected||s.id===r)&&(!s.parentId||!Ji(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&o.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function Sn({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var s,a,c;const o=[];for(const[l,u]of t){const d=(s=n.get(l))==null?void 0:s.internals.userNode;d&&o.push({...d,position:u.position,dragging:r})}if(!e)return[o[0],o];const i=(a=n.get(e))==null?void 0:a.internals.userNode;return[i?{...i,position:((c=t.get(e))==null?void 0:c.position)||i.position,dragging:r}:o[0],o]}function Mf({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},s=0,a=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,h=!1;function p({noDragClassName:v,handleSelector:w,domNode:_,isSelectable:x,nodeId:y,nodeClickDistance:S=0}){f=ce(_);function T({x:O,y:D},R){const{nodeLookup:j,nodeExtent:m,snapGrid:k,snapToGrid:E,nodeOrigin:$,onNodeDrag:C,onSelectionDrag:I,onError:L,updateNodePositions:z}=t();i={x:O,y:D};let B=!1,W={x:0,y:0,x2:0,y2:0};if(a.size>1&&m){const H=Et(a);W=Gn(H)}for(const[H,Y]of a){if(!j.has(H))continue;let X={x:O-Y.distance.x,y:D-Y.distance.y};E&&(X=on(X,k));let q=[[m[0][0],m[0][1]],[m[1][0],m[1][1]]];if(a.size>1&&m&&!Y.extent){const{positionAbsolute:Z}=Y.internals,U=Z.x-W.x+m[0][0],G=Z.x+Y.measured.width-W.x2+m[1][0],J=Z.y-W.y+m[0][1],ee=Z.y+Y.measured.height-W.y2+m[1][1];q=[[U,J],[G,ee]]}const{position:V,positionAbsolute:K}=zi({nodeId:H,nextPosition:X,nodeLookup:j,nodeExtent:q,nodeOrigin:$,onError:L});B=B||Y.position.x!==V.x||Y.position.y!==V.y,Y.position=V,Y.internals.positionAbsolute=K}if(B&&(z(a,!0),R&&(r||C||!y&&I))){const[H,Y]=Sn({nodeId:y,dragItems:a,nodeLookup:j});r==null||r(R,a,H,Y),C==null||C(R,H,Y),y||I==null||I(R,Y)}}async function N(){if(!u)return;const{transform:O,panBy:D,autoPanSpeed:R}=t(),[j,m]=Vi(l,u,R);(j!==0||m!==0)&&(i.x=(i.x??0)-j/O[2],i.y=(i.y??0)-m/O[2],await D({x:j,y:m})&&T(i,null)),s=requestAnimationFrame(N)}function A(O){var B;const{nodeLookup:D,multiSelectionActive:R,nodesDraggable:j,transform:m,snapGrid:k,snapToGrid:E,selectNodesOnDrag:$,onNodeDragStart:C,onSelectionDragStart:I,unselectNodesAndEdges:L}=t();d=!0,(!$||!x)&&!R&&y&&((B=D.get(y))!=null&&B.selected||L()),x&&$&&y&&(e==null||e(y));const z=at(O.sourceEvent,{transform:m,snapGrid:k,snapToGrid:E,containerBounds:u});if(i=z,a=kf(D,j,z,y),a.size>0&&(n||C||!y&&I)){const[W,H]=Sn({nodeId:y,dragItems:a,nodeLookup:D});n==null||n(O.sourceEvent,a,W,H),C==null||C(O.sourceEvent,W,H),y||I==null||I(O.sourceEvent,H)}}const P=wi().clickDistance(S).on("start",O=>{const{domNode:D,nodeDragThreshold:R,transform:j,snapGrid:m,snapToGrid:k}=t();u=(D==null?void 0:D.getBoundingClientRect())||null,h=!1,R===0&&A(O),i=at(O.sourceEvent,{transform:j,snapGrid:m,snapToGrid:k,containerBounds:u}),l=_e(O.sourceEvent,u)}).on("drag",O=>{const{autoPanOnNodeDrag:D,transform:R,snapGrid:j,snapToGrid:m,nodeDragThreshold:k,nodeLookup:E}=t(),$=at(O.sourceEvent,{transform:R,snapGrid:j,snapToGrid:m,containerBounds:u});if((O.sourceEvent.type==="touchmove"&&O.sourceEvent.touches.length>1||y&&!E.has(y))&&(h=!0),!h){if(!c&&D&&d&&(c=!0,N()),!d){const C=$.xSnapped-(i.x??0),I=$.ySnapped-(i.y??0);Math.sqrt(C*C+I*I)>k&&A(O)}(i.x!==$.xSnapped||i.y!==$.ySnapped)&&a&&d&&(l=_e(O.sourceEvent,u),T($,O.sourceEvent))}}).on("end",O=>{if(!(!d||h)&&(c=!1,d=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:D,updateNodePositions:R,onNodeDragStop:j,onSelectionDragStop:m}=t();if(R(a,!1),o||j||!y&&m){const[k,E]=Sn({nodeId:y,dragItems:a,nodeLookup:D,dragging:!1});o==null||o(O.sourceEvent,a,k,E),j==null||j(O.sourceEvent,k,E),y||m==null||m(O.sourceEvent,E)}}}).filter(O=>{const D=O.target;return!O.button&&(!v||!io(D,`.${v}`,_))&&(!w||io(D,w,_))});f.call(P)}function g(){f==null||f.on(".drag",null)}return{update:p,destroy:g}}function If(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())mt(o,Ge(i))>0&&r.push(i);return r}const $f=250;function Pf(e,t,n,r){var a,c;let o=[],i=1/0;const s=If(e,n,t+$f);for(const l of s){const u=[...((a=l.internals.handleBounds)==null?void 0:a.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:h}=yt(l,d,d.position,!0),p=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));p>t||(p<i?(o=[{...d,x:f,y:h}],i=p):p===i&&o.push({...d,x:f,y:h}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(u=>u.type===l)??o[0]}return o[0]}function es(e,t,n,r,o,i=!1){var l,u,d;const s=r.get(e);if(!s)return null;const a=o==="strict"?(l=s.internals.handleBounds)==null?void 0:l[t]:[...((u=s.internals.handleBounds)==null?void 0:u.source)??[],...((d=s.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return c&&i?{...c,...yt(s,c,c.position,!0)}:c}function ts(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Of(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const ns=()=>!0;function Af(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:g,onConnectEnd:v,isValidConnection:w=ns,onReconnectEnd:_,updateConnection:x,getTransform:y,getFromHandle:S,autoPanSpeed:T}){const N=Wi(e.target);let A=0,P;const{x:O,y:D}=_e(e),R=N==null?void 0:N.elementFromPoint(O,D),j=ts(i,R),m=a==null?void 0:a.getBoundingClientRect();if(!m||!j)return;const k=es(o,j,r,c,t);if(!k)return;let E=_e(e,m),$=!1,C=null,I=!1,L=null;function z(){if(!u||!m)return;const[K,Z]=Vi(E,m,T);f({x:K,y:Z}),A=requestAnimationFrame(z)}const B={...k,nodeId:o,type:j,position:k.position},W=c.get(o),Y={inProgress:!0,isValid:null,from:yt(W,B,F.Left,!0),fromHandle:B,fromPosition:B.position,fromNode:W,to:E,toHandle:null,toPosition:Gr[B.position],toNode:null};x(Y);let X=Y;p==null||p(e,{nodeId:o,handleId:r,handleType:j});function q(K){if(!S()||!B){V(K);return}const Z=y();E=_e(K,m),P=Pf(_t(E,Z,!1,[1,1]),n,c,B),$||(z(),$=!0);const U=rs(K,{handle:P,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:s?"target":"source",isValidConnection:w,doc:N,lib:l,flowId:d,nodeLookup:c});L=U.handleDomNode,C=U.connection,I=Of(!!P,U.isValid);const G={...X,isValid:I,to:P&&I?Fi({x:P.x,y:P.y},Z):E,toHandle:U.toHandle,toPosition:I&&U.toHandle?U.toHandle.position:Gr[B.position],toNode:U.toHandle?c.get(U.toHandle.nodeId):null};I&&P&&X.toHandle&&G.toHandle&&X.toHandle.type===G.toHandle.type&&X.toHandle.nodeId===G.toHandle.nodeId&&X.toHandle.id===G.toHandle.id&&X.to.x===G.to.x&&X.to.y===G.to.y||(x(G),X=G)}function V(K){(P||L)&&C&&I&&(g==null||g(C));const{inProgress:Z,...U}=X,G={...U,toPosition:X.toHandle?X.toPosition:null};v==null||v(K,G),i&&(_==null||_(K,G)),h(),cancelAnimationFrame(A),$=!1,I=!1,C=null,L=null,N.removeEventListener("mousemove",q),N.removeEventListener("mouseup",V),N.removeEventListener("touchmove",q),N.removeEventListener("touchend",V)}N.addEventListener("mousemove",q),N.addEventListener("mouseup",V),N.addEventListener("touchmove",q),N.addEventListener("touchend",V)}function rs(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:s,lib:a,flowId:c,isValidConnection:l=ns,nodeLookup:u}){const d=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:p}=_e(e),g=s.elementFromPoint(h,p),v=g!=null&&g.classList.contains(`${a}-flow__handle`)?g:f,w={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const _=ts(void 0,v),x=v.getAttribute("data-nodeid"),y=v.getAttribute("data-handleid"),S=v.classList.contains("connectable"),T=v.classList.contains("connectableend");if(!x||!_)return w;const N={source:d?x:r,sourceHandle:d?y:o,target:d?r:x,targetHandle:d?o:y};w.connection=N;const P=S&&T&&(n===Xe.Strict?d&&_==="source"||!d&&_==="target":x!==r||y!==o);w.isValid=P&&l(N),w.toHandle=es(x,_,y,u,n,!1)}return w}const Qn={onPointerDown:Af,isValid:rs};function Tf({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=ce(e);function i({translateExtent:a,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){const p=x=>{const y=n();if(x.sourceEvent.type!=="wheel"||!t)return;const S=-x.sourceEvent.deltaY*(x.sourceEvent.deltaMode===1?.05:x.sourceEvent.deltaMode?1:.002)*u,T=y[2]*Math.pow(2,S);t.scaleTo(T)};let g=[0,0];const v=x=>{(x.sourceEvent.type==="mousedown"||x.sourceEvent.type==="touchstart")&&(g=[x.sourceEvent.clientX??x.sourceEvent.touches[0].clientX,x.sourceEvent.clientY??x.sourceEvent.touches[0].clientY])},w=x=>{const y=n();if(x.sourceEvent.type!=="mousemove"&&x.sourceEvent.type!=="touchmove"||!t)return;const S=[x.sourceEvent.clientX??x.sourceEvent.touches[0].clientX,x.sourceEvent.clientY??x.sourceEvent.touches[0].clientY],T=[S[0]-g[0],S[1]-g[1]];g=S;const N=r()*Math.max(y[2],Math.log(y[2]))*(h?-1:1),A={x:y[0]-T[0]*N,y:y[1]-T[1]*N},P=[[0,0],[c,l]];t.setViewportConstrained({x:A.x,y:A.y,zoom:y[2]},P,a)},_=Ai().on("start",v).on("zoom",d?w:null).on("zoom.wheel",f?p:null);o.call(_,{})}function s(){o.on("zoom",null)}return{update:i,destroy:s,pointer:fe}}const Lf=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,an=e=>({x:e.x,y:e.y,zoom:e.k}),Cn=({x:e,y:t,zoom:n})=>tn.translate(e,t).scale(n),ze=(e,t)=>e.target.closest(`.${t}`),os=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),kn=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},is=e=>{const t=e.ctrlKey&&Gt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function jf({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(ze(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&s){const v=fe(u),w=is(u),_=d*Math.pow(2,w);r.scaleTo(n,_,v,u);return}const f=u.deltaMode===1?20:1;let h=o===Le.Vertical?0:u.deltaX*f,p=o===Le.Horizontal?0:u.deltaY*f;!Gt()&&u.shiftKey&&o!==Le.Vertical&&(h=u.deltaY*f,p=0),r.translateBy(n,-(h/d)*i,-(p/d)*i,{internal:!0});const g=an(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,g)),e.isPanScrolling&&(c==null||c(u,g),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,g),e.isPanScrolling=!1},150))}}function Rf({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){if(!t&&r.type==="wheel"&&!r.ctrlKey||ze(r,e))return null;r.preventDefault(),n.call(this,r,o)}}function Df({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var i,s,a;if((i=r.sourceEvent)!=null&&i.internal)return;const o=an(r.transform);e.mouseButton=((s=r.sourceEvent)==null?void 0:s.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function zf({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{var s,a;e.usedRightMouseButton=!!(n&&os(t,e.mouseButton??0)),(s=i.sourceEvent)!=null&&s.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!((a=i.sourceEvent)!=null&&a.internal)&&(o==null||o(i.sourceEvent,an(i.transform)))}}function Bf({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return s=>{var a;if(!((a=s.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,i&&os(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&Lf(e.prevViewport,s.transform))){const c=an(s.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(s.sourceEvent,c)},n?150:0)}}}function Vf({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:c,lib:l}){return u=>{var p;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(ze(u,`${l}-flow__node`)||ze(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!o&&!i&&!n||s||ze(u,a)&&u.type==="wheel"||ze(u,c)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((p=u.touches)==null?void 0:p.length)>1)return u.preventDefault(),!1;if(!d&&!o&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function Hf({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:i,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=Ai().clickDistance(!pe(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=ce(e).call(f);x({x:i.x,y:i.y,zoom:We(i.zoom,t,n)},[[0,0],[d.width,d.height]],o);const p=h.on("wheel.zoom"),g=h.on("dblclick.zoom");f.wheelDelta(is);function v(R,j){return h?new Promise(m=>{f==null||f.transform(kn(h,j==null?void 0:j.duration,()=>m(!0)),R)}):Promise.resolve(!1)}function w({noWheelClassName:R,noPanClassName:j,onPaneContextMenu:m,userSelectionActive:k,panOnScroll:E,panOnDrag:$,panOnScrollMode:C,panOnScrollSpeed:I,preventScrolling:L,zoomOnPinch:z,zoomOnScroll:B,zoomOnDoubleClick:W,zoomActivationKeyPressed:H,lib:Y,onTransformChange:X}){k&&!u.isZoomingOrPanning&&_();const V=E&&!H&&!k?jf({zoomPanValues:u,noWheelClassName:R,d3Selection:h,d3Zoom:f,panOnScrollMode:C,panOnScrollSpeed:I,zoomOnPinch:z,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:c}):Rf({noWheelClassName:R,preventScrolling:L,d3ZoomHandler:p});if(h.on("wheel.zoom",V,{passive:!1}),!k){const Z=Df({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:a});f.on("start",Z);const U=zf({zoomPanValues:u,panOnDrag:$,onPaneContextMenu:!!m,onPanZoom:s,onTransformChange:X});f.on("zoom",U);const G=Bf({zoomPanValues:u,panOnDrag:$,panOnScroll:E,onPaneContextMenu:m,onPanZoomEnd:c,onDraggingChange:l});f.on("end",G)}const K=Vf({zoomActivationKeyPressed:H,panOnDrag:$,zoomOnScroll:B,panOnScroll:E,zoomOnDoubleClick:W,zoomOnPinch:z,userSelectionActive:k,noPanClassName:j,noWheelClassName:R,lib:Y});f.filter(K),W?h.on("dblclick.zoom",g):h.on("dblclick.zoom",null)}function _(){f.on("zoom",null)}async function x(R,j,m){const k=Cn(R),E=f==null?void 0:f.constrain()(k,j,m);return E&&await v(E),new Promise($=>$(E))}async function y(R,j){const m=Cn(R);return await v(m,j),new Promise(k=>k(m))}function S(R){if(h){const j=Cn(R),m=h.property("__zoom");(m.k!==R.zoom||m.x!==R.x||m.y!==R.y)&&(f==null||f.transform(h,j,null,{sync:!0}))}}function T(){const R=h?Oi(h.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function N(R,j){return h?new Promise(m=>{f==null||f.scaleTo(kn(h,j==null?void 0:j.duration,()=>m(!0)),R)}):Promise.resolve(!1)}function A(R,j){return h?new Promise(m=>{f==null||f.scaleBy(kn(h,j==null?void 0:j.duration,()=>m(!0)),R)}):Promise.resolve(!1)}function P(R){f==null||f.scaleExtent(R)}function O(R){f==null||f.translateExtent(R)}function D(R){const j=!pe(R)||R<0?0:R;f==null||f.clickDistance(j)}return{update:w,destroy:_,setViewport:y,setViewportConstrained:x,getViewport:T,scaleTo:N,scaleBy:A,setScaleExtent:P,setTranslateExtent:O,syncViewport:S,setClickDistance:D}}var ct;(function(e){e.Line="line",e.Handle="handle"})(ct||(ct={}));function Ff({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:i}){const s=e-t,a=n-r,c=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&o&&(c[0]=c[0]*-1),a&&i&&(c[1]=c[1]*-1),c}function Yf(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function ke(e,t){return Math.max(0,t-e)}function Me(e,t){return Math.max(0,e-t)}function Pt(e,t,n){return Math.max(0,t-e,e-n)}function so(e,t){return e?!t:t}function Xf(e,t,n,r,o,i,s,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:h,ySnapped:p}=n,{minWidth:g,maxWidth:v,minHeight:w,maxHeight:_}=r,{x,y,width:S,height:T,aspectRatio:N}=e;let A=Math.floor(u?h-e.pointerX:0),P=Math.floor(d?p-e.pointerY:0);const O=S+(c?-A:A),D=T+(l?-P:P),R=-i[0]*S,j=-i[1]*T;let m=Pt(O,g,v),k=Pt(D,w,_);if(s){let C=0,I=0;c&&A<0?C=ke(x+A+R,s[0][0]):!c&&A>0&&(C=Me(x+O+R,s[1][0])),l&&P<0?I=ke(y+P+j,s[0][1]):!l&&P>0&&(I=Me(y+D+j,s[1][1])),m=Math.max(m,C),k=Math.max(k,I)}if(a){let C=0,I=0;c&&A>0?C=Me(x+A,a[0][0]):!c&&A<0&&(C=ke(x+O,a[1][0])),l&&P>0?I=Me(y+P,a[0][1]):!l&&P<0&&(I=ke(y+D,a[1][1])),m=Math.max(m,C),k=Math.max(k,I)}if(o){if(u){const C=Pt(O/N,w,_)*N;if(m=Math.max(m,C),s){let I=0;!c&&!l||c&&!l&&f?I=Me(y+j+O/N,s[1][1])*N:I=ke(y+j+(c?A:-A)/N,s[0][1])*N,m=Math.max(m,I)}if(a){let I=0;!c&&!l||c&&!l&&f?I=ke(y+O/N,a[1][1])*N:I=Me(y+(c?A:-A)/N,a[0][1])*N,m=Math.max(m,I)}}if(d){const C=Pt(D*N,g,v)/N;if(k=Math.max(k,C),s){let I=0;!c&&!l||l&&!c&&f?I=Me(x+D*N+R,s[1][0])/N:I=ke(x+(l?P:-P)*N+R,s[0][0])/N,k=Math.max(k,I)}if(a){let I=0;!c&&!l||l&&!c&&f?I=ke(x+D*N,a[1][0])/N:I=Me(x+(l?P:-P)*N,a[0][0])/N,k=Math.max(k,I)}}}P=P+(P<0?k:-k),A=A+(A<0?m:-m),o&&(f?O>D*N?P=(so(c,l)?-A:A)/N:A=(so(c,l)?-P:P)*N:u?(P=A/N,l=c):(A=P*N,c=l));const E=c?x+A:x,$=l?y+P:y;return{width:S+(c?-A:A),height:T+(l?-P:P),x:i[0]*A*(c?-1:1)+E,y:i[1]*P*(l?-1:1)+$}}const ss={width:0,height:0,x:0,y:0},Wf={...ss,pointerX:0,pointerY:0,aspectRatio:1};function Gf(e){return[[0,0],[e.measured.width,e.measured.height]]}function qf(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,c=n[1]*s;return[[r-a,o-c],[r+i-a,o+s-c]]}function Kf({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const i=ce(e);function s({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:h,shouldResize:p}){let g={...ss},v={...Wf};const w=Yf(c);let _,x=null,y=[],S,T,N;const A=wi().on("start",P=>{const{nodeLookup:O,transform:D,snapGrid:R,snapToGrid:j,nodeOrigin:m,paneDomNode:k}=n();if(_=O.get(t),!_)return;x=(k==null?void 0:k.getBoundingClientRect())??null;const{xSnapped:E,ySnapped:$}=at(P.sourceEvent,{transform:D,snapGrid:R,snapToGrid:j,containerBounds:x});g={width:_.measured.width??0,height:_.measured.height??0,x:_.position.x??0,y:_.position.y??0},v={...g,pointerX:E,pointerY:$,aspectRatio:g.width/g.height},S=void 0,_.parentId&&(_.extent==="parent"||_.expandParent)&&(S=O.get(_.parentId),T=S&&_.extent==="parent"?Gf(S):void 0),y=[],N=void 0;for(const[C,I]of O)if(I.parentId===t&&(y.push({id:C,position:{...I.position},extent:I.extent}),I.extent==="parent"||I.expandParent)){const L=qf(I,_,I.origin??m);N?N=[[Math.min(L[0][0],N[0][0]),Math.min(L[0][1],N[0][1])],[Math.max(L[1][0],N[1][0]),Math.max(L[1][1],N[1][1])]]:N=L}d==null||d(P,{...g})}).on("drag",P=>{const{transform:O,snapGrid:D,snapToGrid:R,nodeOrigin:j}=n(),m=at(P.sourceEvent,{transform:O,snapGrid:D,snapToGrid:R,containerBounds:x}),k=[];if(!_)return;const{x:E,y:$,width:C,height:I}=g,L={},z=_.origin??j,{width:B,height:W,x:H,y:Y}=Xf(v,w,m,l,u,z,T,N),X=B!==C,q=W!==I,V=H!==E&&X,K=Y!==$&&q;if(!V&&!K&&!X&&!q)return;if((V||K||z[0]===1||z[1]===1)&&(L.x=V?H:g.x,L.y=K?Y:g.y,g.x=L.x,g.y=L.y,y.length>0)){const J=H-E,ee=Y-$;for(const se of y)se.position={x:se.position.x-J+z[0]*(B-C),y:se.position.y-ee+z[1]*(W-I)},k.push(se)}if((X||q)&&(L.width=X?B:g.width,L.height=q?W:g.height,g.width=L.width,g.height=L.height),S&&_.expandParent){const J=z[0]*(L.width??0);L.x&&L.x<J&&(g.x=J,v.x=v.x-(L.x-J));const ee=z[1]*(L.height??0);L.y&&L.y<ee&&(g.y=ee,v.y=v.y-(L.y-ee))}const Z=Ff({width:g.width,prevWidth:C,height:g.height,prevHeight:I,affectsX:w.affectsX,affectsY:w.affectsY}),U={...g,direction:Z};(p==null?void 0:p(P,U))!==!1&&(f==null||f(P,U),r(L,k))}).on("end",P=>{h==null||h(P,{...g}),o==null||o()});i.call(A)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}var as={exports:{}},cs={},ls={exports:{}},us={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ke=M;function Uf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zf=typeof Object.is=="function"?Object.is:Uf,Qf=Ke.useState,Jf=Ke.useEffect,eh=Ke.useLayoutEffect,th=Ke.useDebugValue;function nh(e,t){var n=t(),r=Qf({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return eh(function(){o.value=n,o.getSnapshot=t,Mn(o)&&i({inst:o})},[e,n,t]),Jf(function(){return Mn(o)&&i({inst:o}),e(function(){Mn(o)&&i({inst:o})})},[e]),th(n),n}function Mn(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zf(e,n)}catch{return!0}}function rh(e,t){return t()}var oh=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?rh:nh;us.useSyncExternalStore=Ke.useSyncExternalStore!==void 0?Ke.useSyncExternalStore:oh;ls.exports=us;var ih=ls.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cn=M,sh=ih;function ah(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ch=typeof Object.is=="function"?Object.is:ah,lh=sh.useSyncExternalStore,uh=cn.useRef,dh=cn.useEffect,fh=cn.useMemo,hh=cn.useDebugValue;cs.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=uh(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=fh(function(){function c(h){if(!l){if(l=!0,u=h,h=r(h),o!==void 0&&s.hasValue){var p=s.value;if(o(p,h))return d=p}return d=h}if(p=d,ch(u,h))return p;var g=r(h);return o!==void 0&&o(p,g)?(u=h,p):(u=h,d=g)}var l=!1,u,d,f=n===void 0?null:n;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,n,r,o]);var a=lh(e,i[0],i[1]);return dh(function(){s.hasValue=!0,s.value=a},[a]),hh(a),a};as.exports=cs;var ph=as.exports;const gh=ri(ph),ao=e=>{let t;const n=new Set,r=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{n.clear()}},l=t=e(r,o,c);return c},mh=e=>e?ao(e):ao,{useDebugValue:yh}=kc,{useSyncExternalStoreWithSelector:wh}=gh,xh=e=>e;function ds(e,t=xh,n){const r=wh(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return yh(r),r}const co=(e,t)=>{const n=mh(e),r=(o,i=t)=>ds(n,o,i);return Object.assign(r,n),r},bh=(e,t)=>e?co(e,t):co;function ne(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const ln=M.createContext(null),vh=ln.Provider,fs=Se.error001();function Q(e,t){const n=M.useContext(ln);if(n===null)throw new Error(fs);return ds(n,e,t)}function te(){const e=M.useContext(ln);if(e===null)throw new Error(fs);return M.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const lo={display:"none"},Eh={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},hs="react-flow__node-desc",ps="react-flow__edge-desc",_h="react-flow__aria-live",Nh=e=>e.ariaLiveMessage;function Sh({rfId:e}){const t=Q(Nh);return b.jsx("div",{id:`${_h}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Eh,children:t})}function Ch({rfId:e,disableKeyboardA11y:t}){return b.jsxs(b.Fragment,{children:[b.jsxs("div",{id:`${hs}-${e}`,style:lo,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),b.jsx("div",{id:`${ps}-${e}`,style:lo,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&b.jsx(Sh,{rfId:e})]})}const kh=e=>e.userSelectionActive?"none":"all",mr=M.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},i)=>{const s=Q(kh),a=`${e}`.split("-");return b.jsx("div",{className:ie(["react-flow__panel",n,...a]),style:{...r,pointerEvents:s},ref:i,...o,children:t})});function Mh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:b.jsx(mr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:b.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Ih=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Ot=e=>e.id;function $h(e,t){return ne(e.selectedNodes.map(Ot),t.selectedNodes.map(Ot))&&ne(e.selectedEdges.map(Ot),t.selectedEdges.map(Ot))}function Ph({onSelectionChange:e}){const t=te(),{selectedNodes:n,selectedEdges:r}=Q(Ih,$h);return M.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(i=>i(o))},[n,r,e]),null}const Oh=e=>!!e.onSelectionChangeHandlers;function Ah({onSelectionChange:e}){const t=Q(Oh);return e||t?b.jsx(Ph,{onSelectionChange:e}):null}const gs=[0,0],Th={x:0,y:0,zoom:1},Lh=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],uo=[...Lh,"rfId"],jh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),fo={translateExtent:pt,nodeOrigin:gs,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Rh(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Q(jh,ne),u=te();M.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=fo,a()}),[]);const d=M.useRef(fo);return M.useEffect(()=>{for(const f of uo){const h=e[f],p=d.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?o(h):f==="translateExtent"?i(h):f==="nodeExtent"?s(h):f==="paneClickDistance"?l(h):f==="fitView"?u.setState({fitViewOnInit:h}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:h}):u.setState({[f]:h})))}d.current=e},uo.map(f=>e[f])),null}function ho(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Dh(e){var r;const[t,n]=M.useState(e==="system"?null:e);return M.useEffect(()=>{if(e!=="system"){n(e);return}const o=ho(),i=()=>n(o!=null&&o.matches?"dark":"light");return i(),o==null||o.addEventListener("change",i),()=>{o==null||o.removeEventListener("change",i)}},[e]),t!==null?t:(r=ho())!=null&&r.matches?"dark":"light"}const po=typeof document<"u"?document:null;function wt(e=null,t={target:po,actInsideInputWithModifier:!0}){const[n,r]=M.useState(!1),o=M.useRef(!1),i=M.useRef(new Set([])),[s,a]=M.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=l.reduce((d,f)=>d.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return M.useEffect(()=>{const c=(t==null?void 0:t.target)||po;if(e!==null){const l=f=>{if(o.current=f.ctrlKey||f.metaKey||f.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&qn(f))return!1;const p=mo(f.code,a);i.current.add(f[p]),go(s,i.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&qn(f))return!1;const p=mo(f.code,a);go(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(f[p]),f.key==="Meta"&&i.current.clear(),o.current=!1},d=()=>{i.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function go(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function mo(e,t){return t.includes(e)?"code":"key"}const zh=()=>{const e=te();return M.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??i},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:o,panZoom:i,domNode:s}=e.getState();if(!i||!s)return Promise.resolve(!1);const a=Xn(n,t),{width:c,height:l}=sn(s);return Wn({nodes:a,width:c,height:l,minZoom:r,maxZoom:o,panZoom:i},t)},setCenter:async(t,n,r)=>{const{width:o,height:i,maxZoom:s,panZoom:a}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:s,l=o/2-t*c,u=i/2-n*c;return a?(await a.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),c=ur(t,r,o,i,s,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:o,domNode:i}=e.getState();if(!i)return t;const{x:s,y:a}=i.getBoundingClientRect(),c={x:t.x-s,y:t.y-a};return _t(c,r,n.snapToGrid,o)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:i}=r.getBoundingClientRect(),s=Fi(t,n);return{x:s.x+o,y:s.y+i}}}),[])};function ms(e,t){const n=[],r=new Map,o=[];for(const i of e)if(i.type==="add"){o.push(i);continue}else if(i.type==="remove"||i.type==="replace")r.set(i.id,[i]);else{const s=r.get(i.id);s?s.push(i):r.set(i.id,[i])}for(const i of t){const s=r.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const c of s)Bh(c,a);n.push(a)}return o.length&&o.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function Bh(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function ys(e,t){return ms(e,t)}function ws(e,t){return ms(e,t)}function Oe(e,t){return{id:e,type:"select",selected:t}}function Be(e,t=new Set,n=!1){const r=[];for(const[o,i]of e){const s=t.has(o);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),r.push(Oe(i.id,s)))}return r}function yo({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(i=>[i.id,i]));for(const[i,s]of e.entries()){const a=t.get(s.id),c=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;c!==void 0&&c!==s&&n.push({id:s.id,item:s,type:"replace"}),c===void 0&&n.push({item:s,type:"add",index:i})}for(const[i]of t)r.get(i)===void 0&&n.push({id:i,type:"remove"});return n}function wo(e){return{id:e.id,type:"remove"}}const xo=e=>of(e),Vh=e=>Ri(e);function xs(e){return M.forwardRef(e)}const Hh=typeof window<"u"?M.useLayoutEffect:M.useEffect;function bo(e){const[t,n]=M.useState(BigInt(0)),[r]=M.useState(()=>Fh(()=>n(o=>o+BigInt(1))));return Hh(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function Fh(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const bs=M.createContext(null);function Yh({children:e}){const t=te(),n=M.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState();let h=c;for(const p of a)h=typeof p=="function"?p(h):p;u?l(h):d&&d(yo({items:h,lookup:f}))},[]),r=bo(n),o=M.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let h=c;for(const p of a)h=typeof p=="function"?p(h):p;u?l(h):d&&d(yo({items:h,lookup:f}))},[]),i=bo(o),s=M.useMemo(()=>({nodeQueue:r,edgeQueue:i}),[]);return b.jsx(bs.Provider,{value:s,children:e})}function Xh(){const e=M.useContext(bs);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Wh=e=>!!e.panZoom;function yr(){const e=zh(),t=te(),n=Xh(),r=Q(Wh),o=M.useMemo(()=>{const i=d=>t.getState().nodeLookup.get(d),s=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},c=d=>{var w,_;const{nodeLookup:f,nodeOrigin:h}=t.getState(),p=xo(d)?d:f.get(d.id),g=p.parentId?Xi(p.position,p.measured,p.parentId,f,h):p.position,v={...p,position:g,width:((w=p.measured)==null?void 0:w.width)??p.width,height:((_=p.measured)==null?void 0:_.height)??p.height};return Ge(v)},l=(d,f,h={replace:!1})=>{s(p=>p.map(g=>{if(g.id===d){const v=typeof f=="function"?f(g):f;return h.replace&&xo(v)?v:{...g,...v}}return g}))},u=(d,f,h={replace:!1})=>{a(p=>p.map(g=>{if(g.id===d){const v=typeof f=="function"?f(g):f;return h.replace&&Vh(v)?v:{...g,...v}}return g}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=i(d))==null?void 0:f.internals.userNode},getInternalNode:i,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:s,setEdges:a,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:h}=t.getState(),[p,g,v]=h;return{nodes:d.map(w=>({...w})),edges:f.map(w=>({...w})),viewport:{x:p,y:g,zoom:v}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:h,edges:p,onNodesDelete:g,onEdgesDelete:v,triggerNodeChanges:w,triggerEdgeChanges:_,onDelete:x,onBeforeDelete:y}=t.getState(),{nodes:S,edges:T}=await cf({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:y}),N=T.length>0,A=S.length>0;if(N){const P=T.map(wo);v==null||v(T),_(P)}if(A){const P=S.map(wo);g==null||g(S),w(P)}return(A||N)&&(x==null||x({nodes:S,edges:T})),{deletedNodes:S,deletedEdges:T}},getIntersectingNodes:(d,f=!0,h)=>{const p=Kr(d),g=p?d:c(d),v=h!==void 0;return g?(h||t.getState().nodes).filter(w=>{const _=t.getState().nodeLookup.get(w.id);if(_&&!p&&(w.id===d.id||!_.internals.positionAbsolute))return!1;const x=Ge(v?w:_),y=mt(x,g);return f&&y>0||y>=g.width*g.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{const g=Kr(d)?d:c(d);if(!g)return!1;const v=mt(g,f);return h&&v>0||v>=g.width*g.height},updateNode:l,updateNodeData:(d,f,h={replace:!1})=>{l(d,p=>{const g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},updateEdge:u,updateEdgeData:(d,f,h={replace:!1})=>{u(d,p=>{const g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return sf(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}-${d}${f?`-${f}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:d,handleId:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}${d?f?`-${d}-${f}`:`-${d}`:""}`))==null?void 0:p.values())??[])}}},[]);return M.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const vo=e=>e.selected,Gh={actInsideInputWithModifier:!1},qh=typeof window<"u"?window:void 0;function Kh({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=te(),{deleteElements:r}=yr(),o=wt(e,Gh),i=wt(t,{target:qh});M.useEffect(()=>{if(o){const{edges:s,nodes:a}=n.getState();r({nodes:a.filter(vo),edges:s.filter(vo)}),n.setState({nodesSelectionActive:!1})}},[o]),M.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function Uh(e){const t=te();M.useEffect(()=>{const n=()=>{var o,i;if(!e.current)return!1;const r=sn(e.current);(r.height===0||r.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",Se.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const un={position:"absolute",width:"100%",height:"100%",top:0,left:0},Zh=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Qh({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:i=Le.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:g,noPanClassName:v,onViewportChange:w,isControlledViewport:_,paneClickDistance:x}){const y=te(),S=M.useRef(null),{userSelectionActive:T,lib:N}=Q(Zh,ne),A=wt(f),P=M.useRef();Uh(S);const O=M.useCallback(D=>{w==null||w({x:D[0],y:D[1],zoom:D[2]}),_||y.setState({transform:D})},[w,_]);return M.useEffect(()=>{if(S.current){P.current=Hf({domNode:S.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:x,onDraggingChange:m=>y.setState({paneDragging:m}),onPanZoomStart:(m,k)=>{const{onViewportChangeStart:E,onMoveStart:$}=y.getState();$==null||$(m,k),E==null||E(k)},onPanZoom:(m,k)=>{const{onViewportChange:E,onMove:$}=y.getState();$==null||$(m,k),E==null||E(k)},onPanZoomEnd:(m,k)=>{const{onViewportChangeEnd:E,onMoveEnd:$}=y.getState();$==null||$(m,k),E==null||E(k)}});const{x:D,y:R,zoom:j}=P.current.getViewport();return y.setState({panZoom:P.current,transform:[D,R,j],domNode:S.current.closest(".react-flow")}),()=>{var m;(m=P.current)==null||m.destroy()}}},[]),M.useEffect(()=>{var D;(D=P.current)==null||D.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:A,preventScrolling:h,noPanClassName:v,userSelectionActive:T,noWheelClassName:g,lib:N,onTransformChange:O})},[e,t,n,r,o,i,s,a,A,h,v,T,g,N,O]),b.jsx("div",{className:"react-flow__renderer",ref:S,style:un,children:p})}const Jh=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function ep(){const{userSelectionActive:e,userSelectionRect:t}=Q(Jh,ne);return e&&t?b.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const In=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},tp=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function np({isSelecting:e,selectionKeyPressed:t,selectionMode:n=gt.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:i,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:h}){const p=te(),{userSelectionActive:g,elementsSelectable:v,dragging:w}=Q(tp,ne),_=v&&(e||g),x=M.useRef(null),y=M.useRef(),S=M.useRef(new Set),T=M.useRef(new Set),N=M.useRef(!1),A=M.useRef(!1),P=E=>{if(N.current){N.current=!1;return}a==null||a(E),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},O=E=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){E.preventDefault();return}c==null||c(E)},D=l?E=>l(E):void 0,R=E=>{var z,B;const{resetSelectedElements:$,domNode:C}=p.getState();if(y.current=C==null?void 0:C.getBoundingClientRect(),!v||!e||E.button!==0||E.target!==x.current||!y.current)return;(B=(z=E.target)==null?void 0:z.setPointerCapture)==null||B.call(z,E.pointerId),A.current=!0,N.current=!1;const{x:I,y:L}=_e(E.nativeEvent,y.current);$(),p.setState({userSelectionRect:{width:0,height:0,startX:I,startY:L,x:I,y:L}}),i==null||i(E)},j=E=>{const{userSelectionRect:$,transform:C,nodeLookup:I,edgeLookup:L,connectionLookup:z,triggerNodeChanges:B,triggerEdgeChanges:W,defaultEdgeOptions:H}=p.getState();if(!y.current||!$)return;N.current=!0;const{x:Y,y:X}=_e(E.nativeEvent,y.current),{startX:q,startY:V}=$,K={startX:q,startY:V,x:Y<q?Y:q,y:X<V?X:V,width:Math.abs(Y-q),height:Math.abs(X-V)},Z=S.current,U=T.current;S.current=new Set(Di(I,K,C,n===gt.Partial,!0).map(J=>J.id)),T.current=new Set;const G=(H==null?void 0:H.selectable)??!0;for(const J of S.current){const ee=z.get(J);if(ee)for(const{edgeId:se}of ee.values()){const de=L.get(se);de&&(de.selectable??G)&&T.current.add(se)}}if(!Ur(Z,S.current)){const J=Be(I,S.current,!0);B(J)}if(!Ur(U,T.current)){const J=Be(L,T.current);W(J)}p.setState({userSelectionRect:K,userSelectionActive:!0,nodesSelectionActive:!1})},m=E=>{var C,I;if(E.button!==0||!A.current)return;(I=(C=E.target)==null?void 0:C.releasePointerCapture)==null||I.call(C,E.pointerId);const{userSelectionRect:$}=p.getState();!g&&$&&E.target===x.current&&(P==null||P(E)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:S.current.size>0}),s==null||s(E),(t||o)&&(N.current=!1),A.current=!1},k=r===!0||Array.isArray(r)&&r.includes(0);return b.jsxs("div",{className:ie(["react-flow__pane",{draggable:k,dragging:w,selection:e}]),onClick:_?void 0:In(P,x),onContextMenu:In(O,x),onWheel:In(D,x),onPointerEnter:_?void 0:u,onPointerDown:_?R:d,onPointerMove:_?j:d,onPointerUp:_?m:void 0,onPointerLeave:f,ref:x,style:un,children:[h,b.jsx(ep,{})]})}function Jn({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",Se.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&s)&&(i({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):o([e])}function vs({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,nodeClickDistance:s}){const a=te(),[c,l]=M.useState(!1),u=M.useRef();return M.useEffect(()=>{u.current=Mf({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{Jn({id:d,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),M.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:i,nodeId:o,nodeClickDistance:s}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,r,t,i,e,o]),c}const rp=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Es(){const e=te();return M.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:u}=e.getState(),d=new Map,f=rp(s),h=o?i[0]:5,p=o?i[1]:5,g=n.direction.x*h*n.factor,v=n.direction.y*p*n.factor;for(const[,w]of l){if(!f(w))continue;let _={x:w.internals.positionAbsolute.x+g,y:w.internals.positionAbsolute.y+v};o&&(_=on(_,i));const{position:x,positionAbsolute:y}=zi({nodeId:w.id,nextPosition:_,nodeLookup:l,nodeExtent:r,nodeOrigin:u,onError:a});w.position=x,w.internals.positionAbsolute=y,d.set(w.id,w)}c(d)},[])}const wr=M.createContext(null),op=wr.Provider;wr.Consumer;const _s=()=>M.useContext(wr),ip=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),sp=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:i,connection:s}=r,{fromHandle:a,toHandle:c,isValid:l}=s,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:i===Xe.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,valid:u&&l}};function ap({type:e="source",position:t=F.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},h){var m,k;const p=s||null,g=e==="target",v=te(),w=_s(),{connectOnClick:_,noPanClassName:x,rfId:y}=Q(ip,ne),{connectingFrom:S,connectingTo:T,clickConnecting:N,isPossibleEndHandle:A,connectionInProcess:P,valid:O}=Q(sp(w,p,e),ne);w||(k=(m=v.getState()).onError)==null||k.call(m,"010",Se.error010());const D=E=>{const{defaultEdgeOptions:$,onConnect:C,hasDefaultEdges:I}=v.getState(),L={...$,...E};if(I){const{edges:z,setEdges:B}=v.getState();B(gf(L,z))}C==null||C(L),a==null||a(L)},R=E=>{if(!w)return;const $=Gi(E.nativeEvent);if(o&&($&&E.button===0||!$)){const C=v.getState();Qn.onPointerDown(E.nativeEvent,{autoPanOnConnect:C.autoPanOnConnect,connectionMode:C.connectionMode,connectionRadius:C.connectionRadius,domNode:C.domNode,nodeLookup:C.nodeLookup,lib:C.lib,isTarget:g,handleId:p,nodeId:w,flowId:C.rfId,panBy:C.panBy,cancelConnection:C.cancelConnection,onConnectStart:C.onConnectStart,onConnectEnd:C.onConnectEnd,updateConnection:C.updateConnection,onConnect:D,isValidConnection:n||C.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:C.autoPanSpeed})}$?u==null||u(E):d==null||d(E)},j=E=>{const{onClickConnectStart:$,onClickConnectEnd:C,connectionClickStartHandle:I,connectionMode:L,isValidConnection:z,lib:B,rfId:W,nodeLookup:H,connection:Y}=v.getState();if(!w||!I&&!o)return;if(!I){$==null||$(E.nativeEvent,{nodeId:w,handleId:p,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:w,type:e,id:p}});return}const X=Wi(E.target),q=n||z,{connection:V,isValid:K}=Qn.isValid(E.nativeEvent,{handle:{nodeId:w,id:p,type:e},connectionMode:L,fromNodeId:I.nodeId,fromHandleId:I.id||null,fromType:I.type,isValidConnection:q,flowId:W,doc:X,lib:B,nodeLookup:H});K&&V&&D(V);const Z=structuredClone(Y);delete Z.inProgress,Z.toPosition=Z.toHandle?Z.toHandle.position:null,C==null||C(E,Z),v.setState({connectionClickStartHandle:null})};return b.jsx("div",{"data-handleid":p,"data-nodeid":w,"data-handlepos":t,"data-id":`${y}-${w}-${p}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",x,l,{source:!g,target:g,connectable:r,connectablestart:o,connectableend:i,clickconnecting:N,connectingfrom:S,connectingto:T,valid:O,connectionindicator:r&&(!P||A)&&(P?i:o)}]),onMouseDown:R,onTouchStart:R,onClick:_?j:void 0,ref:h,...f,children:c})}const Ue=M.memo(xs(ap));function cp({data:e,isConnectable:t,sourcePosition:n=F.Bottom}){return b.jsxs(b.Fragment,{children:[e==null?void 0:e.label,b.jsx(Ue,{type:"source",position:n,isConnectable:t})]})}function lp({data:e,isConnectable:t,targetPosition:n=F.Top,sourcePosition:r=F.Bottom}){return b.jsxs(b.Fragment,{children:[b.jsx(Ue,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,b.jsx(Ue,{type:"source",position:r,isConnectable:t})]})}function up(){return null}function dp({data:e,isConnectable:t,targetPosition:n=F.Top}){return b.jsxs(b.Fragment,{children:[b.jsx(Ue,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const qt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Eo={input:cp,default:lp,output:dp,group:up};function fp(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const hp=e=>{const{width:t,height:n,x:r,y:o}=Et(e.nodeLookup,{filter:i=>!!i.selected});return{width:pe(t)?t:null,height:pe(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function pp({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=te(),{width:o,height:i,transformString:s,userSelectionActive:a}=Q(hp,ne),c=Es(),l=M.useRef(null);if(M.useEffect(()=>{var f;n||(f=l.current)==null||f.focus({preventScroll:!0})},[n]),vs({nodeRef:l}),a||!o||!i)return null;const u=e?f=>{const h=r.getState().nodes.filter(p=>p.selected);e(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(qt,f.key)&&(f.preventDefault(),c({direction:qt[f.key],factor:f.shiftKey?4:1}))};return b.jsx("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:b.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:o,height:i}})})}const _o=typeof window<"u"?window:void 0,gp=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ns({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:g,zoomActivationKeyCode:v,elementsSelectable:w,zoomOnScroll:_,zoomOnPinch:x,panOnScroll:y,panOnScrollSpeed:S,panOnScrollMode:T,zoomOnDoubleClick:N,panOnDrag:A,defaultViewport:P,translateExtent:O,minZoom:D,maxZoom:R,preventScrolling:j,onSelectionContextMenu:m,noWheelClassName:k,noPanClassName:E,disableKeyboardA11y:$,onViewportChange:C,isControlledViewport:I}){const{nodesSelectionActive:L,userSelectionActive:z}=Q(gp),B=wt(l,{target:_o}),W=wt(g,{target:_o}),H=W||A,Y=W||y,X=u&&H!==!0,q=B||z||X;return Kh({deleteKeyCode:c,multiSelectionKeyCode:p}),b.jsx(Qh,{onPaneContextMenu:i,elementsSelectable:w,zoomOnScroll:_,zoomOnPinch:x,panOnScroll:Y,panOnScrollSpeed:S,panOnScrollMode:T,zoomOnDoubleClick:N,panOnDrag:!B&&H,defaultViewport:P,translateExtent:O,minZoom:D,maxZoom:R,zoomActivationKeyCode:v,preventScrolling:j,noWheelClassName:k,noPanClassName:E,onViewportChange:C,isControlledViewport:I,paneClickDistance:a,children:b.jsxs(np,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:H,isSelecting:!!q,selectionMode:d,selectionKeyPressed:B,selectionOnDrag:X,children:[e,L&&b.jsx(pp,{onSelectionContextMenu:m,noPanClassName:E,disableKeyboardA11y:$})]})})}Ns.displayName="FlowRenderer";const mp=M.memo(Ns),yp=e=>t=>e?Di(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function wp(e){return Q(M.useCallback(yp(e),[e]),ne)}const xp=e=>e.updateNodeInternals;function bp(){const e=Q(xp),[t]=M.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const i=o.target.getAttribute("data-id");r.set(i,{id:i,nodeElement:o.target,force:!0})}),e(r)}));return M.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function vp({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=te(),i=M.useRef(null),s=M.useRef(null),a=M.useRef(e.sourcePosition),c=M.useRef(e.targetPosition),l=M.useRef(t),u=n&&!!e.internals.handleBounds;return M.useEffect(()=>{i.current&&!e.hidden&&(!u||s.current!==i.current)&&(s.current&&(r==null||r.unobserve(s.current)),r==null||r.observe(i.current),s.current=i.current)},[u,e.hidden]),M.useEffect(()=>()=>{s.current&&(r==null||r.unobserve(s.current),s.current=null)},[]),M.useEffect(()=>{if(i.current){const d=l.current!==t,f=a.current!==e.sourcePosition,h=c.current!==e.targetPosition;(d||f||h)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function Ep({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:g,nodeTypes:v,nodeExtent:w,nodeClickDistance:_,onError:x}){const{node:y,internals:S,isParent:T}=Q(V=>{const K=V.nodeLookup.get(e),Z=V.parentLookup.has(e);return{node:K,internals:K.internals,isParent:Z}},ne);let N=y.type||"default",A=(v==null?void 0:v[N])||Eo[N];A===void 0&&(x==null||x("003",Se.error003(N)),N="default",A=Eo.default);const P=!!(y.draggable||a&&typeof y.draggable>"u"),O=!!(y.selectable||c&&typeof y.selectable>"u"),D=!!(y.connectable||l&&typeof y.connectable>"u"),R=!!(y.focusable||u&&typeof y.focusable>"u"),j=te(),m=Yi(y),k=vp({node:y,nodeType:N,hasDimensions:m,resizeObserver:d}),E=vs({nodeRef:k,disabled:y.hidden||!P,noDragClassName:f,handleSelector:y.dragHandle,nodeId:e,isSelectable:O,nodeClickDistance:_}),$=Es();if(y.hidden)return null;const C=Ce(y),I=fp(y),L=O||P||t||n||r||o,z=n?V=>n(V,{...S.userNode}):void 0,B=r?V=>r(V,{...S.userNode}):void 0,W=o?V=>o(V,{...S.userNode}):void 0,H=i?V=>i(V,{...S.userNode}):void 0,Y=s?V=>s(V,{...S.userNode}):void 0,X=V=>{const{selectNodesOnDrag:K,nodeDragThreshold:Z}=j.getState();O&&(!K||!P||Z>0)&&Jn({id:e,store:j,nodeRef:k}),t&&t(V,{...S.userNode})},q=V=>{if(!(qn(V.nativeEvent)||p))if(Ti.includes(V.key)&&O){const K=V.key==="Escape";Jn({id:e,store:j,unselect:K,nodeRef:k})}else P&&y.selected&&Object.prototype.hasOwnProperty.call(qt,V.key)&&(V.preventDefault(),j.setState({ariaLiveMessage:`Moved selected node ${V.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~S.positionAbsolute.x}, y: ${~~S.positionAbsolute.y}`}),$({direction:qt[V.key],factor:V.shiftKey?4:1}))};return b.jsx("div",{className:ie(["react-flow__node",`react-flow__node-${N}`,{[h]:P},y.className,{selected:y.selected,selectable:O,parent:T,draggable:P,dragging:E}]),ref:k,style:{zIndex:S.z,transform:`translate(${S.positionAbsolute.x}px,${S.positionAbsolute.y}px)`,pointerEvents:L?"all":"none",visibility:m?"visible":"hidden",...y.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:B,onMouseLeave:W,onContextMenu:H,onClick:X,onDoubleClick:Y,onKeyDown:R?q:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":p?void 0:`${hs}-${g}`,"aria-label":y.ariaLabel,children:b.jsx(op,{value:e,children:b.jsx(A,{id:e,data:y.data,type:N,positionAbsoluteX:S.positionAbsolute.x,positionAbsoluteY:S.positionAbsolute.y,selected:y.selected??!1,selectable:O,draggable:P,deletable:y.deletable??!0,isConnectable:D,sourcePosition:y.sourcePosition,targetPosition:y.targetPosition,dragging:E,dragHandle:y.dragHandle,zIndex:S.z,parentId:y.parentId,...C})})})}const _p=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ss(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:i}=Q(_p,ne),s=wp(e.onlyRenderVisibleElements),a=bp();return b.jsx("div",{className:"react-flow__nodes",style:un,children:s.map(c=>b.jsx(Ep,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:i},c))})}Ss.displayName="NodeRenderer";const Np=M.memo(Ss);function Sp(e){return Q(M.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const i=n.nodeLookup.get(o.source),s=n.nodeLookup.get(o.target);i&&s&&ff({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),ne)}const Cp=({color:e="none",strokeWidth:t=1})=>b.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),kp=({color:e="none",strokeWidth:t=1})=>b.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),No={[Xt.Arrow]:Cp,[Xt.ArrowClosed]:kp};function Mp(e){const t=te();return M.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(No,e)?No[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",Se.error009(e)),null)},[e])}const Ip=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=Mp(t);return c?b.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:b.jsx(c,{color:n,strokeWidth:s})}):null},Cs=({defaultColor:e,rfId:t})=>{const n=Q(i=>i.edges),r=Q(i=>i.defaultEdgeOptions),o=M.useMemo(()=>bf(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?b.jsx("svg",{className:"react-flow__marker",children:b.jsx("defs",{children:o.map(i=>b.jsx(Ip,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Cs.displayName="MarkerDefinitions";var $p=M.memo(Cs);function ks({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u}){const[d,f]=M.useState({x:1,y:0,width:0,height:0}),h=ie(["react-flow__edge-textwrapper",l]),p=M.useRef(null);return M.useEffect(()=>{if(p.current){const g=p.current.getBBox();f({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:b.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...u,children:[o&&b.jsx("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),b.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:p,style:r,children:n}),c]})}ks.displayName="EdgeText";const Pp=M.memo(ks);function dn({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...u}){return b.jsxs(b.Fragment,{children:[b.jsx("path",{...u,d:e,fill:"none",className:ie(["react-flow__edge-path",u.className])}),l&&b.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}),r&&pe(t)&&pe(n)?b.jsx(Pp,{x:t,y:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function So({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===F.Left||e===F.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Ms({sourceX:e,sourceY:t,sourcePosition:n=F.Bottom,targetX:r,targetY:o,targetPosition:i=F.Top}){const[s,a]=So({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=So({pos:i,x1:r,y1:o,x2:e,y2:t}),[u,d,f,h]=qi({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${s},${a} ${c},${l} ${r},${o}`,u,d,f,h]}function Is(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=F.Bottom,targetPosition:a=F.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:w})=>{const[_,x,y]=Ms({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a}),S=e.isInternal?void 0:t;return b.jsx(dn,{id:S,path:_,labelX:x,labelY:y,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:w})})}const Op=Is({isInternal:!1}),$s=Is({isInternal:!0});Op.displayName="SimpleBezierEdge";$s.displayName="SimpleBezierEdgeInternal";function Ps(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:h=F.Bottom,targetPosition:p=F.Top,markerEnd:g,markerStart:v,pathOptions:w,interactionWidth:_})=>{const[x,y,S]=Kn({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:i,targetPosition:p,borderRadius:w==null?void 0:w.borderRadius,offset:w==null?void 0:w.offset}),T=e.isInternal?void 0:t;return b.jsx(dn,{id:T,path:x,labelX:y,labelY:S,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:g,markerStart:v,interactionWidth:_})})}const Os=Ps({isInternal:!1}),As=Ps({isInternal:!0});Os.displayName="SmoothStepEdge";As.displayName="SmoothStepEdgeInternal";function Ts(e){return M.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return b.jsx(Os,{...n,id:r,pathOptions:M.useMemo(()=>{var i;return{borderRadius:0,offset:(i=n.pathOptions)==null?void 0:i.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const Ap=Ts({isInternal:!1}),Ls=Ts({isInternal:!0});Ap.displayName="StepEdge";Ls.displayName="StepEdgeInternal";function js(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:g})=>{const[v,w,_]=Ui({sourceX:n,sourceY:r,targetX:o,targetY:i}),x=e.isInternal?void 0:t;return b.jsx(dn,{id:x,path:v,labelX:w,labelY:_,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:g})})}const Tp=js({isInternal:!1}),Rs=js({isInternal:!0});Tp.displayName="StraightEdge";Rs.displayName="StraightEdgeInternal";function Ds(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=F.Bottom,targetPosition:a=F.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,pathOptions:w,interactionWidth:_})=>{const[x,y,S]=dr({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a,curvature:w==null?void 0:w.curvature}),T=e.isInternal?void 0:t;return b.jsx(dn,{id:T,path:x,labelX:y,labelY:S,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:_})})}const Lp=Ds({isInternal:!1}),zs=Ds({isInternal:!0});Lp.displayName="BezierEdge";zs.displayName="BezierEdgeInternal";const Co={default:zs,straight:Rs,step:Ls,smoothstep:As,simplebezier:$s},ko={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},jp=(e,t,n)=>n===F.Left?e-t:n===F.Right?e+t:e,Rp=(e,t,n)=>n===F.Top?e-t:n===F.Bottom?e+t:e,Mo="react-flow__edgeupdater";function Io({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a}){return b.jsx("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:ie([Mo,`${Mo}-${a}`]),cx:jp(t,r,e),cy:Rp(n,r,e),r,stroke:"transparent",fill:"transparent"})}function Dp({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:i,targetY:s,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){const p=te(),g=(y,S)=>{if(y.button!==0)return;const{autoPanOnConnect:T,domNode:N,isValidConnection:A,connectionMode:P,connectionRadius:O,lib:D,onConnectStart:R,onConnectEnd:j,cancelConnection:m,nodeLookup:k,rfId:E,panBy:$,updateConnection:C}=p.getState(),I=S.type==="target";f(!0),u==null||u(y,n,S.type);const L=(B,W)=>{f(!1),d==null||d(B,n,S.type,W)},z=B=>l==null?void 0:l(n,B);Qn.onPointerDown(y.nativeEvent,{autoPanOnConnect:T,connectionMode:P,connectionRadius:O,domNode:N,handleId:S.id,nodeId:S.nodeId,nodeLookup:k,isTarget:I,edgeUpdaterType:S.type,lib:D,flowId:E,cancelConnection:m,panBy:$,isValidConnection:A,onConnect:z,onConnectStart:R,onConnectEnd:j,onReconnectEnd:L,updateConnection:C,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},v=y=>g(y,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),w=y=>g(y,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),_=()=>h(!0),x=()=>h(!1);return b.jsxs(b.Fragment,{children:[(e===!0||e==="source")&&b.jsx(Io,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:v,onMouseEnter:_,onMouseOut:x,type:"source"}),(e===!0||e==="target")&&b.jsx(Io,{position:c,centerX:i,centerY:s,radius:t,onMouseDown:w,onMouseEnter:_,onMouseOut:x,type:"target"})]})}function zp({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:g,noPanClassName:v,onError:w,disableKeyboardA11y:_}){let x=Q(G=>G.edgeLookup.get(e));const y=Q(G=>G.defaultEdgeOptions);x=y?{...y,...x}:x;let S=x.type||"default",T=(g==null?void 0:g[S])||Co[S];T===void 0&&(w==null||w("011",Se.error011(S)),S="default",T=Co.default);const N=!!(x.focusable||t&&typeof x.focusable>"u"),A=typeof d<"u"&&(x.reconnectable||n&&typeof x.reconnectable>"u"),P=!!(x.selectable||r&&typeof x.selectable>"u"),O=M.useRef(null),[D,R]=M.useState(!1),[j,m]=M.useState(!1),k=te(),{zIndex:E,sourceX:$,sourceY:C,targetX:I,targetY:L,sourcePosition:z,targetPosition:B}=Q(M.useCallback(G=>{const J=G.nodeLookup.get(x.source),ee=G.nodeLookup.get(x.target);if(!J||!ee)return{zIndex:x.zIndex,...ko};const se=xf({id:e,sourceNode:J,targetNode:ee,sourceHandle:x.sourceHandle||null,targetHandle:x.targetHandle||null,connectionMode:G.connectionMode,onError:w});return{zIndex:df({selected:x.selected,zIndex:x.zIndex,sourceNode:J,targetNode:ee,elevateOnSelect:G.elevateEdgesOnSelect}),...se||ko}},[x.source,x.target,x.sourceHandle,x.targetHandle,x.selected,x.zIndex]),ne),W=M.useMemo(()=>x.markerStart?`url('#${Un(x.markerStart,p)}')`:void 0,[x.markerStart,p]),H=M.useMemo(()=>x.markerEnd?`url('#${Un(x.markerEnd,p)}')`:void 0,[x.markerEnd,p]);if(x.hidden||$===null||C===null||I===null||L===null)return null;const Y=G=>{var de;const{addSelectedEdges:J,unselectNodesAndEdges:ee,multiSelectionActive:se}=k.getState();P&&(k.setState({nodesSelectionActive:!1}),x.selected&&se?(ee({nodes:[],edges:[x]}),(de=O.current)==null||de.blur()):J([e])),o&&o(G,x)},X=i?G=>{i(G,{...x})}:void 0,q=s?G=>{s(G,{...x})}:void 0,V=a?G=>{a(G,{...x})}:void 0,K=c?G=>{c(G,{...x})}:void 0,Z=l?G=>{l(G,{...x})}:void 0,U=G=>{var J;if(!_&&Ti.includes(G.key)&&P){const{unselectNodesAndEdges:ee,addSelectedEdges:se}=k.getState();G.key==="Escape"?((J=O.current)==null||J.blur(),ee({edges:[x]})):se([e])}};return b.jsx("svg",{style:{zIndex:E},children:b.jsxs("g",{className:ie(["react-flow__edge",`react-flow__edge-${S}`,x.className,v,{selected:x.selected,animated:x.animated,inactive:!P&&!o,updating:D,selectable:P}]),onClick:Y,onDoubleClick:X,onContextMenu:q,onMouseEnter:V,onMouseMove:K,onMouseLeave:Z,onKeyDown:N?U:void 0,tabIndex:N?0:void 0,role:N?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":x.ariaLabel===null?void 0:x.ariaLabel||`Edge from ${x.source} to ${x.target}`,"aria-describedby":N?`${ps}-${p}`:void 0,ref:O,children:[!j&&b.jsx(T,{id:e,source:x.source,target:x.target,type:x.type,selected:x.selected,animated:x.animated,selectable:P,deletable:x.deletable??!0,label:x.label,labelStyle:x.labelStyle,labelShowBg:x.labelShowBg,labelBgStyle:x.labelBgStyle,labelBgPadding:x.labelBgPadding,labelBgBorderRadius:x.labelBgBorderRadius,sourceX:$,sourceY:C,targetX:I,targetY:L,sourcePosition:z,targetPosition:B,data:x.data,style:x.style,sourceHandleId:x.sourceHandle,targetHandleId:x.targetHandle,markerStart:W,markerEnd:H,pathOptions:"pathOptions"in x?x.pathOptions:void 0,interactionWidth:x.interactionWidth}),A&&b.jsx(Dp,{edge:x,isReconnectable:A,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:$,sourceY:C,targetX:I,targetY:L,sourcePosition:z,targetPosition:B,setUpdateHover:R,setReconnecting:m})]})})}const Bp=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Bs({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:g}){const{edgesFocusable:v,edgesReconnectable:w,elementsSelectable:_,onError:x}=Q(Bp,ne),y=Sp(t);return b.jsxs("div",{className:"react-flow__edges",children:[b.jsx($p,{defaultColor:e,rfId:n}),y.map(S=>b.jsx(zp,{id:S,edgesFocusable:v,edgesReconnectable:w,elementsSelectable:_,noPanClassName:o,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:x,edgeTypes:r,disableKeyboardA11y:g},S))]})}Bs.displayName="EdgeRenderer";const Vp=M.memo(Bs),Hp=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Fp({children:e}){const t=Q(Hp);return b.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Yp(e){const t=yr(),n=M.useRef(!1);M.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Xp=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Wp(e){const t=Q(Xp),n=te();return M.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function $o(e){return e.connection.inProgress?{...e.connection,to:_t(e.connection.to,e.transform)}:{...e.connection}}function Gp(e){return e?n=>{const r=$o(n);return e(r)}:$o}function qp(e){const t=Gp(e);return Q(t,ne)}const Kp=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Up({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:i,height:s,isValid:a,inProgress:c}=Q(Kp,ne);return!(i&&o&&c)?null:b.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:b.jsx("g",{className:ie(["react-flow__connection",ji(a)]),children:b.jsx(Vs,{style:t,type:n,CustomComponent:r,isValid:a})})})}const Vs=({style:e,type:t=be.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:i,fromNode:s,fromHandle:a,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=qp();if(!o)return;if(n)return b.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:ji(r),toNode:u,toHandle:d});let h="";const p={sourceX:i.x,sourceY:i.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case be.Bezier:[h]=dr(p);break;case be.SimpleBezier:[h]=Ms(p);break;case be.Step:[h]=Kn({...p,borderRadius:0});break;case be.SmoothStep:[h]=Kn(p);break;default:[h]=Ui(p)}return b.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Vs.displayName="ConnectionLine";const Zp={};function Po(e=Zp){M.useRef(e),te(),M.useEffect(()=>{},[e])}function Qp(){te(),M.useRef(!1),M.useEffect(()=>{},[])}function Hs({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:g,connectionLineComponent:v,connectionLineContainerStyle:w,selectionKeyCode:_,selectionOnDrag:x,selectionMode:y,multiSelectionKeyCode:S,panActivationKeyCode:T,zoomActivationKeyCode:N,deleteKeyCode:A,onlyRenderVisibleElements:P,elementsSelectable:O,defaultViewport:D,translateExtent:R,minZoom:j,maxZoom:m,preventScrolling:k,defaultMarkerColor:E,zoomOnScroll:$,zoomOnPinch:C,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:z,zoomOnDoubleClick:B,panOnDrag:W,onPaneClick:H,onPaneMouseEnter:Y,onPaneMouseMove:X,onPaneMouseLeave:q,onPaneScroll:V,onPaneContextMenu:K,paneClickDistance:Z,nodeClickDistance:U,onEdgeContextMenu:G,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:se,reconnectRadius:de,onReconnect:pn,onReconnectStart:gn,onReconnectEnd:mn,noDragClassName:Ze,noWheelClassName:yn,noPanClassName:Qe,disableKeyboardA11y:Je,nodeExtent:wn,rfId:et,viewport:tt,onViewportChange:Nt}){return Po(e),Po(t),Qp(),Yp(n),Wp(tt),b.jsx(mp,{onPaneClick:H,onPaneMouseEnter:Y,onPaneMouseMove:X,onPaneMouseLeave:q,onPaneContextMenu:K,onPaneScroll:V,paneClickDistance:Z,deleteKeyCode:A,selectionKeyCode:_,selectionOnDrag:x,selectionMode:y,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:S,panActivationKeyCode:T,zoomActivationKeyCode:N,elementsSelectable:O,zoomOnScroll:$,zoomOnPinch:C,zoomOnDoubleClick:B,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:z,panOnDrag:W,defaultViewport:D,translateExtent:R,minZoom:j,maxZoom:m,onSelectionContextMenu:d,preventScrolling:k,noDragClassName:Ze,noWheelClassName:yn,noPanClassName:Qe,disableKeyboardA11y:Je,onViewportChange:Nt,isControlledViewport:!!tt,children:b.jsxs(Fp,{children:[b.jsx(Vp,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:s,onReconnect:pn,onReconnectStart:gn,onReconnectEnd:mn,onlyRenderVisibleElements:P,onEdgeContextMenu:G,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:se,reconnectRadius:de,defaultMarkerColor:E,noPanClassName:Qe,disableKeyboardA11y:Je,rfId:et}),b.jsx(Up,{style:g,type:p,component:v,containerStyle:w}),b.jsx("div",{className:"react-flow__edgelabel-renderer"}),b.jsx(Np,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:U,onlyRenderVisibleElements:P,noPanClassName:Qe,noDragClassName:Ze,disableKeyboardA11y:Je,nodeExtent:wn,rfId:et}),b.jsx("div",{className:"react-flow__viewport-portal"})]})})}Hs.displayName="GraphView";const Jp=M.memo(Hs),Oo=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,f=new Map,h=r??t??[],p=n??e??[],g=a??[0,0],v=c??pt;Qi(d,f,h),Zn(p,l,u,{nodeOrigin:g,nodeExtent:v,elevateNodesOnSelect:!1});let w=[0,0,1];if(s&&o&&i){const _=Et(l,{filter:T=>!!((T.width||T.initialWidth)&&(T.height||T.initialHeight))}),{x,y,zoom:S}=ur(_,o,i,.5,2,.1);w=[x,y,S]}return{rfId:"1",width:0,height:0,transform:w,nodes:p,nodeLookup:l,parentLookup:u,edges:h,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:pt,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Xe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...Li},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:lf,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},eg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c})=>bh((l,u)=>({...Oo({nodes:e,edges:t,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:f,parentLookup:h,nodeOrigin:p,elevateNodesOnSelect:g}=u();Zn(d,f,h,{nodeOrigin:p,nodeExtent:c,elevateNodesOnSelect:g,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:f,edgeLookup:h}=u();Qi(f,h,d),l({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){const{setNodes:h}=u();h(d),l({hasDefaultNodes:!0})}if(f){const{setEdges:h}=u();h(f),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{const{triggerNodeChanges:h,nodeLookup:p,parentLookup:g,fitViewOnInit:v,fitViewDone:w,fitViewOnInitOptions:_,domNode:x,nodeOrigin:y,nodeExtent:S,debug:T,fitViewSync:N}=u(),{changes:A,updatedInternals:P}=Sf(d,p,g,x,y,S);if(P){if(Ef(p,g,{nodeOrigin:y,nodeExtent:S}),f.triggerFitView){let O=w;!w&&v&&(O=N({..._,nodes:_==null?void 0:_.nodes})),l({fitViewDone:O})}else l({});(A==null?void 0:A.length)>0&&(T&&console.log("React Flow: trigger node changes",A),h==null||h(A))}},updateNodePositions:(d,f=!1)=>{const h=[],p=[];for(const[g,v]of d){const w=!!(v!=null&&v.expandParent&&(v!=null&&v.parentId)&&(v!=null&&v.position)),_={id:g,type:"position",position:w?{x:Math.max(0,v.position.x),y:Math.max(0,v.position.y)}:v.position,dragging:f};w&&h.push({id:g,parentId:v.parentId,rect:{...v.internals.positionAbsolute,width:v.measured.width,height:v.measured.height}}),p.push(_)}if(h.length>0){const{nodeLookup:g,parentLookup:v,nodeOrigin:w}=u(),_=gr(h,g,v,w);p.push(..._)}u().triggerNodeChanges(p)},triggerNodeChanges:d=>{const{onNodesChange:f,setNodes:h,nodes:p,hasDefaultNodes:g,debug:v}=u();if(d!=null&&d.length){if(g){const w=ys(d,p);h(w)}v&&console.log("React Flow: trigger node changes",d),f==null||f(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:f,setEdges:h,edges:p,hasDefaultEdges:g,debug:v}=u();if(d!=null&&d.length){if(g){const w=ws(d,p);h(w)}v&&console.log("React Flow: trigger edge changes",d),f==null||f(d)}},addSelectedNodes:d=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:v}=u();if(f){const w=d.map(_=>Oe(_,!0));g(w);return}g(Be(p,new Set([...d]),!0)),v(Be(h))},addSelectedEdges:d=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:v}=u();if(f){const w=d.map(_=>Oe(_,!0));v(w);return}v(Be(h,new Set([...d]))),g(Be(p,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{const{edges:h,nodes:p,nodeLookup:g,triggerNodeChanges:v,triggerEdgeChanges:w}=u(),_=d||p,x=f||h,y=_.map(T=>{const N=g.get(T.id);return N&&(N.selected=!1),Oe(T.id,!1)}),S=x.map(T=>Oe(T.id,!1));v(y),w(S)},setMinZoom:d=>{const{panZoom:f,maxZoom:h}=u();f==null||f.setScaleExtent([d,h]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:f,minZoom:h}=u();f==null||f.setScaleExtent([h,d]),l({maxZoom:d})},setTranslateExtent:d=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var f;(f=u().panZoom)==null||f.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:f,triggerNodeChanges:h,triggerEdgeChanges:p}=u(),g=f.reduce((w,_)=>_.selected?[...w,Oe(_.id,!1)]:w,[]),v=d.reduce((w,_)=>_.selected?[...w,Oe(_.id,!1)]:w,[]);h(g),p(v)},setNodeExtent:d=>{const{nodes:f,nodeLookup:h,parentLookup:p,nodeOrigin:g,elevateNodesOnSelect:v,nodeExtent:w}=u();d[0][0]===w[0][0]&&d[0][1]===w[0][1]&&d[1][0]===w[1][0]&&d[1][1]===w[1][1]||(Zn(f,h,p,{nodeOrigin:g,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:f,width:h,height:p,panZoom:g,translateExtent:v}=u();return Cf({delta:d,panZoom:g,transform:f,translateExtent:v,width:h,height:p})},fitView:d=>{const{panZoom:f,width:h,height:p,minZoom:g,maxZoom:v,nodeLookup:w}=u();if(!f)return Promise.resolve(!1);const _=Xn(w,d);return Wn({nodes:_,width:h,height:p,panZoom:f,minZoom:g,maxZoom:v},d)},fitViewSync:d=>{const{panZoom:f,width:h,height:p,minZoom:g,maxZoom:v,nodeLookup:w}=u();if(!f)return!1;const _=Xn(w,d);return Wn({nodes:_,width:h,height:p,panZoom:f,minZoom:g,maxZoom:v},d),_.size>0},cancelConnection:()=>{l({connection:{...Li}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...Oo()})}),Object.is);function tg({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:a,nodeExtent:c,children:l}){const[u]=M.useState(()=>eg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c}));return b.jsx(vh,{value:u,children:b.jsx(Yh,{children:l})})}function ng({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:i,height:s,fitView:a,nodeOrigin:c,nodeExtent:l}){return M.useContext(ln)?b.jsx(b.Fragment,{children:e}):b.jsx(tg,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:i,initialHeight:s,fitView:a,nodeOrigin:c,nodeExtent:l,children:e})}const rg={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function og({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:w,onNodeMouseEnter:_,onNodeMouseMove:x,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:T,onNodeDragStart:N,onNodeDrag:A,onNodeDragStop:P,onNodesDelete:O,onEdgesDelete:D,onDelete:R,onSelectionChange:j,onSelectionDragStart:m,onSelectionDrag:k,onSelectionDragStop:E,onSelectionContextMenu:$,onSelectionStart:C,onSelectionEnd:I,onBeforeDelete:L,connectionMode:z,connectionLineType:B=be.Bezier,connectionLineStyle:W,connectionLineComponent:H,connectionLineContainerStyle:Y,deleteKeyCode:X="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:V=!1,selectionMode:K=gt.Full,panActivationKeyCode:Z="Space",multiSelectionKeyCode:U=Gt()?"Meta":"Control",zoomActivationKeyCode:G=Gt()?"Meta":"Control",snapToGrid:J,snapGrid:ee,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:de,nodesDraggable:pn,nodesConnectable:gn,nodesFocusable:mn,nodeOrigin:Ze=gs,edgesFocusable:yn,edgesReconnectable:Qe,elementsSelectable:Je=!0,defaultViewport:wn=Th,minZoom:et=.5,maxZoom:tt=2,translateExtent:Nt=pt,preventScrolling:Sa=!0,nodeExtent:xn,defaultMarkerColor:Ca="#b1b1b7",zoomOnScroll:ka=!0,zoomOnPinch:Ma=!0,panOnScroll:Ia=!1,panOnScrollSpeed:$a=.5,panOnScrollMode:Pa=Le.Free,zoomOnDoubleClick:Oa=!0,panOnDrag:Aa=!0,onPaneClick:Ta,onPaneMouseEnter:La,onPaneMouseMove:ja,onPaneMouseLeave:Ra,onPaneScroll:Da,onPaneContextMenu:za,paneClickDistance:Nr=0,nodeClickDistance:Ba=0,children:Va,onReconnect:Ha,onReconnectStart:Fa,onReconnectEnd:Ya,onEdgeContextMenu:Xa,onEdgeDoubleClick:Wa,onEdgeMouseEnter:Ga,onEdgeMouseMove:qa,onEdgeMouseLeave:Ka,reconnectRadius:Ua=10,onNodesChange:Za,onEdgesChange:Qa,noDragClassName:Ja="nodrag",noWheelClassName:ec="nowheel",noPanClassName:Sr="nopan",fitView:Cr,fitViewOptions:tc,connectOnClick:nc,attributionPosition:rc,proOptions:oc,defaultEdgeOptions:ic,elevateNodesOnSelect:sc,elevateEdgesOnSelect:ac,disableKeyboardA11y:kr=!1,autoPanOnConnect:cc,autoPanOnNodeDrag:lc,autoPanSpeed:uc,connectionRadius:dc,isValidConnection:fc,onError:hc,style:pc,id:Mr,nodeDragThreshold:gc,viewport:mc,onViewportChange:yc,width:wc,height:xc,colorMode:bc="light",debug:vc,...Ec},_c){const bn=Mr||"1",Nc=Dh(bc);return b.jsx("div",{"data-testid":"rf__wrapper",...Ec,style:{...pc,...rg},ref:_c,className:ie(["react-flow",o,Nc]),id:Mr,children:b.jsxs(ng,{nodes:e,edges:t,width:wc,height:xc,fitView:Cr,nodeOrigin:Ze,nodeExtent:xn,children:[b.jsx(Jp,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:_,onNodeMouseMove:x,onNodeMouseLeave:y,onNodeContextMenu:S,onNodeDoubleClick:T,nodeTypes:i,edgeTypes:s,connectionLineType:B,connectionLineStyle:W,connectionLineComponent:H,connectionLineContainerStyle:Y,selectionKeyCode:q,selectionOnDrag:V,selectionMode:K,deleteKeyCode:X,multiSelectionKeyCode:U,panActivationKeyCode:Z,zoomActivationKeyCode:G,onlyRenderVisibleElements:se,defaultViewport:wn,translateExtent:Nt,minZoom:et,maxZoom:tt,preventScrolling:Sa,zoomOnScroll:ka,zoomOnPinch:Ma,zoomOnDoubleClick:Oa,panOnScroll:Ia,panOnScrollSpeed:$a,panOnScrollMode:Pa,panOnDrag:Aa,onPaneClick:Ta,onPaneMouseEnter:La,onPaneMouseMove:ja,onPaneMouseLeave:Ra,onPaneScroll:Da,onPaneContextMenu:za,paneClickDistance:Nr,nodeClickDistance:Ba,onSelectionContextMenu:$,onSelectionStart:C,onSelectionEnd:I,onReconnect:Ha,onReconnectStart:Fa,onReconnectEnd:Ya,onEdgeContextMenu:Xa,onEdgeDoubleClick:Wa,onEdgeMouseEnter:Ga,onEdgeMouseMove:qa,onEdgeMouseLeave:Ka,reconnectRadius:Ua,defaultMarkerColor:Ca,noDragClassName:Ja,noWheelClassName:ec,noPanClassName:Sr,rfId:bn,disableKeyboardA11y:kr,nodeExtent:xn,viewport:mc,onViewportChange:yc}),b.jsx(Rh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:w,nodesDraggable:pn,nodesConnectable:gn,nodesFocusable:mn,edgesFocusable:yn,edgesReconnectable:Qe,elementsSelectable:Je,elevateNodesOnSelect:sc,elevateEdgesOnSelect:ac,minZoom:et,maxZoom:tt,nodeExtent:xn,onNodesChange:Za,onEdgesChange:Qa,snapToGrid:J,snapGrid:ee,connectionMode:z,translateExtent:Nt,connectOnClick:nc,defaultEdgeOptions:ic,fitView:Cr,fitViewOptions:tc,onNodesDelete:O,onEdgesDelete:D,onDelete:R,onNodeDragStart:N,onNodeDrag:A,onNodeDragStop:P,onSelectionDrag:k,onSelectionDragStart:m,onSelectionDragStop:E,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:Sr,nodeOrigin:Ze,rfId:bn,autoPanOnConnect:cc,autoPanOnNodeDrag:lc,autoPanSpeed:uc,onError:hc,connectionRadius:dc,isValidConnection:fc,selectNodesOnDrag:de,nodeDragThreshold:gc,onBeforeDelete:L,paneClickDistance:Nr,debug:vc}),b.jsx(Ah,{onSelectionChange:j}),Va,b.jsx(Mh,{proOptions:oc,position:rc}),b.jsx(Ch,{rfId:bn,disableKeyboardA11y:kr})]})})}var ig=xs(og);function sg(e){const[t,n]=M.useState(e),r=M.useCallback(o=>n(i=>ys(o,i)),[]);return[t,n,r]}function ag(e){const[t,n]=M.useState(e),r=M.useCallback(o=>n(i=>ws(o,i)),[]);return[t,n,r]}function cg({dimensions:e,lineWidth:t,variant:n,className:r}){return b.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ie(["react-flow__background-pattern",n,r])})}function lg({radius:e,className:t}){return b.jsx("circle",{cx:e,cy:e,r:e,className:ie(["react-flow__background-pattern","dots",t])})}var $e;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})($e||($e={}));const ug={[$e.Dots]:1,[$e.Lines]:1,[$e.Cross]:6},dg=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Fs({id:e,variant:t=$e.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=0,color:s,bgColor:a,style:c,className:l,patternClassName:u}){const d=M.useRef(null),{transform:f,patternId:h}=Q(dg,ne),p=r||ug[t],g=t===$e.Dots,v=t===$e.Cross,w=Array.isArray(n)?n:[n,n],_=[w[0]*f[2]||1,w[1]*f[2]||1],x=p*f[2],y=Array.isArray(i)?i:[i,i],S=v?[x,x]:_,T=[y[0]*f[2]||1+S[0]/2,y[1]*f[2]||1+S[1]/2],N=`${h}${e||""}`;return b.jsxs("svg",{className:ie(["react-flow__background",l]),style:{...c,...un,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:d,"data-testid":"rf__background",children:[b.jsx("pattern",{id:N,x:f[0]%_[0],y:f[1]%_[1],width:_[0],height:_[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${T[0]},-${T[1]})`,children:g?b.jsx(lg,{radius:x/2,className:u}):b.jsx(cg,{dimensions:S,lineWidth:o,variant:t,className:u})}),b.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}Fs.displayName="Background";M.memo(Fs);function fg(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:b.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function hg(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:b.jsx("path",{d:"M0 0h32v4.2H0z"})})}function pg(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:b.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function gg(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function mg(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function At({children:e,className:t,...n}){return b.jsx("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n,children:e})}const yg=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Ys({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){const p=te(),{isInteractive:g,minZoomReached:v,maxZoomReached:w}=Q(yg,ne),{zoomIn:_,zoomOut:x,fitView:y}=yr(),S=()=>{_(),i==null||i()},T=()=>{x(),s==null||s()},N=()=>{y(o),a==null||a()},A=()=>{p.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),c==null||c(!g)},P=f==="horizontal"?"horizontal":"vertical";return b.jsxs(mr,{className:ie(["react-flow__controls",P,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&b.jsxs(b.Fragment,{children:[b.jsx(At,{onClick:S,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:w,children:b.jsx(fg,{})}),b.jsx(At,{onClick:T,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:b.jsx(hg,{})})]}),n&&b.jsx(At,{className:"react-flow__controls-fitview",onClick:N,title:"fit view","aria-label":"fit view",children:b.jsx(pg,{})}),r&&b.jsx(At,{className:"react-flow__controls-interactive",onClick:A,title:"toggle interactivity","aria-label":"toggle interactivity",children:g?b.jsx(mg,{}):b.jsx(gg,{})}),u]})}Ys.displayName="Controls";const wg=M.memo(Ys);function xg({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:h}){const{background:p,backgroundColor:g}=i||{},v=s||p||g;return b.jsx("rect",{className:ie(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:o,style:{fill:v,stroke:a,strokeWidth:c},shapeRendering:d,onClick:h?w=>h(w,e):void 0})}const bg=M.memo(xg),vg=e=>e.nodes.map(t=>t.id),$n=e=>e instanceof Function?e:()=>e;function Eg({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:i=bg,onClick:s}){const a=Q(vg,ne),c=$n(t),l=$n(e),u=$n(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return b.jsx(b.Fragment,{children:a.map(f=>b.jsx(Ng,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:i,onClick:s,shapeRendering:d},f))})}function _g({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:c}){const{node:l,x:u,y:d,width:f,height:h}=Q(p=>{const g=p.nodeLookup.get(e),{x:v,y:w}=g.internals.positionAbsolute,{width:_,height:x}=Ce(g);return{node:g,x:v,y:w,width:_,height:x}},ne);return!l||l.hidden||!Yi(l)?null:b.jsx(a,{x:u,y:d,width:f,height:h,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:i,shapeRendering:s,onClick:c,id:l.id})}const Ng=M.memo(_g);var Sg=M.memo(Eg);const Cg=200,kg=150,Mg=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Hi(Et(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Ig="react-flow__minimap-desc";function Xs({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:g=!1,zoomable:v=!1,ariaLabel:w="React Flow mini map",inversePan:_,zoomStep:x=10,offsetScale:y=5}){const S=te(),T=M.useRef(null),{boundingRect:N,viewBB:A,rfId:P,panZoom:O,translateExtent:D,flowWidth:R,flowHeight:j}=Q(Mg,ne),m=(e==null?void 0:e.width)??Cg,k=(e==null?void 0:e.height)??kg,E=N.width/m,$=N.height/k,C=Math.max(E,$),I=C*m,L=C*k,z=y*C,B=N.x-(I-N.width)/2-z,W=N.y-(L-N.height)/2-z,H=I+z*2,Y=L+z*2,X=`${Ig}-${P}`,q=M.useRef(0),V=M.useRef();q.current=C,M.useEffect(()=>{if(T.current&&O)return V.current=Tf({domNode:T.current,panZoom:O,getTransform:()=>S.getState().transform,getViewScale:()=>q.current}),()=>{var U;(U=V.current)==null||U.destroy()}},[O]),M.useEffect(()=>{var U;(U=V.current)==null||U.update({translateExtent:D,width:R,height:j,inversePan:_,pannable:g,zoomStep:x,zoomable:v})},[g,v,_,x,D,R,j]);const K=h?U=>{var ee;const[G,J]=((ee=V.current)==null?void 0:ee.pointer(U))||[0,0];h(U,{x:G,y:J})}:void 0,Z=p?M.useCallback((U,G)=>{const J=S.getState().nodeLookup.get(G);p(U,J)},[]):void 0;return b.jsx(mr,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*C:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="string"?s:void 0},className:ie(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:b.jsxs("svg",{width:m,height:k,viewBox:`${B} ${W} ${H} ${Y}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":X,ref:T,onClick:K,children:[w&&b.jsx("title",{id:X,children:w}),b.jsx(Sg,{onClick:Z,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:s,nodeComponent:a}),b.jsx("path",{className:"react-flow__minimap-mask",d:`M${B-z},${W-z}h${H+z*2}v${Y+z*2}h${-H-z*2}z
        M${A.x},${A.y}h${A.width}v${A.height}h${-A.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Xs.displayName="MiniMap";M.memo(Xs);function $g({nodeId:e,position:t,variant:n=ct.Handle,className:r,style:o={},children:i,color:s,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:h,onResize:p,onResizeEnd:g}){const v=_s(),w=typeof e=="string"?e:v,_=te(),x=M.useRef(null),y=n===ct.Line?"right":"bottom-right",S=t??y,T=M.useRef(null);M.useEffect(()=>{if(!(!x.current||!w))return T.current||(T.current=Kf({domNode:x.current,nodeId:w,getStoreItems:()=>{const{nodeLookup:O,transform:D,snapGrid:R,snapToGrid:j,nodeOrigin:m,domNode:k}=_.getState();return{nodeLookup:O,transform:D,snapGrid:R,snapToGrid:j,nodeOrigin:m,paneDomNode:k}},onChange:(O,D)=>{const{triggerNodeChanges:R,nodeLookup:j,parentLookup:m,nodeOrigin:k}=_.getState(),E=[],$={x:O.x,y:O.y},C=j.get(w);if(C&&C.expandParent&&C.parentId){const I=C.origin??k,L=O.width??C.measured.width,z=O.height??C.measured.height,B={id:C.id,parentId:C.parentId,rect:{width:L,height:z,...Xi({x:O.x??C.position.x,y:O.y??C.position.y},{width:L,height:z},C.parentId,j,I)}},W=gr([B],j,m,k);E.push(...W),$.x=O.x?Math.max(I[0]*L,O.x):void 0,$.y=O.y?Math.max(I[1]*z,O.y):void 0}if($.x!==void 0&&$.y!==void 0){const I={id:w,type:"position",position:{...$}};E.push(I)}if(O.width!==void 0&&O.height!==void 0){const I={id:w,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:O.width,height:O.height}};E.push(I)}for(const I of D){const L={...I,type:"position"};E.push(L)}R(E)},onEnd:()=>{const O={id:w,type:"dimensions",resizing:!1};_.getState().triggerNodeChanges([O])}})),T.current.update({controlPosition:S,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:h,onResize:p,onResizeEnd:g,shouldResize:f}),()=>{var O;(O=T.current)==null||O.destroy()}},[S,a,c,l,u,d,h,p,g,f]);const N=S.split("-"),A=n===ct.Line?"borderColor":"backgroundColor",P=s?{...o,[A]:s}:o;return b.jsx("div",{className:ie(["react-flow__resize-control","nodrag",...N,n,r]),ref:x,style:P,children:i})}M.memo($g);var Pg="\0",Pe="\0",Ao="";let Og=class{constructor(t){re(this,"_isDirected",!0);re(this,"_isMultigraph",!1);re(this,"_isCompound",!1);re(this,"_label");re(this,"_defaultNodeLabelFn",()=>{});re(this,"_defaultEdgeLabelFn",()=>{});re(this,"_nodes",{});re(this,"_in",{});re(this,"_preds",{});re(this,"_out",{});re(this,"_sucs",{});re(this,"_edgeObjs",{});re(this,"_edgeLabels",{});re(this,"_nodeCount",0);re(this,"_edgeCount",0);re(this,"_parent");re(this,"_children");t&&(this._isDirected=Object.hasOwn(t,"directed")?t.directed:!0,this._isMultigraph=Object.hasOwn(t,"multigraph")?t.multigraph:!1,this._isCompound=Object.hasOwn(t,"compound")?t.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[Pe]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(t){return this._label=t,this}graph(){return this._label}setDefaultNodeLabel(t){return this._defaultNodeLabelFn=t,typeof t!="function"&&(this._defaultNodeLabelFn=()=>t),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var t=this;return this.nodes().filter(n=>Object.keys(t._in[n]).length===0)}sinks(){var t=this;return this.nodes().filter(n=>Object.keys(t._out[n]).length===0)}setNodes(t,n){var r=arguments,o=this;return t.forEach(function(i){r.length>1?o.setNode(i,n):o.setNode(i)}),this}setNode(t,n){return Object.hasOwn(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=n),this):(this._nodes[t]=arguments.length>1?n:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=Pe,this._children[t]={},this._children[Pe][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)}node(t){return this._nodes[t]}hasNode(t){return Object.hasOwn(this._nodes,t)}removeNode(t){var n=this;if(Object.hasOwn(this._nodes,t)){var r=o=>n.removeEdge(n._edgeObjs[o]);delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],this.children(t).forEach(function(o){n.setParent(o)}),delete this._children[t]),Object.keys(this._in[t]).forEach(r),delete this._in[t],delete this._preds[t],Object.keys(this._out[t]).forEach(r),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this}setParent(t,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n===void 0)n=Pe;else{n+="";for(var r=n;r!==void 0;r=this.parent(r))if(r===t)throw new Error("Setting "+n+" as parent of "+t+" would create a cycle");this.setNode(n)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=n,this._children[n][t]=!0,this}_removeFromParentsChildList(t){delete this._children[this._parent[t]][t]}parent(t){if(this._isCompound){var n=this._parent[t];if(n!==Pe)return n}}children(t=Pe){if(this._isCompound){var n=this._children[t];if(n)return Object.keys(n)}else{if(t===Pe)return this.nodes();if(this.hasNode(t))return[]}}predecessors(t){var n=this._preds[t];if(n)return Object.keys(n)}successors(t){var n=this._sucs[t];if(n)return Object.keys(n)}neighbors(t){var n=this.predecessors(t);if(n){const o=new Set(n);for(var r of this.successors(t))o.add(r);return Array.from(o.values())}}isLeaf(t){var n;return this.isDirected()?n=this.successors(t):n=this.neighbors(t),n.length===0}filterNodes(t){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;Object.entries(this._nodes).forEach(function([s,a]){t(s)&&n.setNode(s,a)}),Object.values(this._edgeObjs).forEach(function(s){n.hasNode(s.v)&&n.hasNode(s.w)&&n.setEdge(s,r.edge(s))});var o={};function i(s){var a=r.parent(s);return a===void 0||n.hasNode(a)?(o[s]=a,a):a in o?o[a]:i(a)}return this._isCompound&&n.nodes().forEach(s=>n.setParent(s,i(s))),n}setDefaultEdgeLabel(t){return this._defaultEdgeLabelFn=t,typeof t!="function"&&(this._defaultEdgeLabelFn=()=>t),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(t,n){var r=this,o=arguments;return t.reduce(function(i,s){return o.length>1?r.setEdge(i,s,n):r.setEdge(i,s),s}),this}setEdge(){var t,n,r,o,i=!1,s=arguments[0];typeof s=="object"&&s!==null&&"v"in s?(t=s.v,n=s.w,r=s.name,arguments.length===2&&(o=arguments[1],i=!0)):(t=s,n=arguments[1],r=arguments[3],arguments.length>2&&(o=arguments[2],i=!0)),t=""+t,n=""+n,r!==void 0&&(r=""+r);var a=st(this._isDirected,t,n,r);if(Object.hasOwn(this._edgeLabels,a))return i&&(this._edgeLabels[a]=o),this;if(r!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(n),this._edgeLabels[a]=i?o:this._defaultEdgeLabelFn(t,n,r);var c=Ag(this._isDirected,t,n,r);return t=c.v,n=c.w,Object.freeze(c),this._edgeObjs[a]=c,To(this._preds[n],t),To(this._sucs[t],n),this._in[n][a]=c,this._out[t][a]=c,this._edgeCount++,this}edge(t,n,r){var o=arguments.length===1?Pn(this._isDirected,arguments[0]):st(this._isDirected,t,n,r);return this._edgeLabels[o]}edgeAsObj(){const t=this.edge(...arguments);return typeof t!="object"?{label:t}:t}hasEdge(t,n,r){var o=arguments.length===1?Pn(this._isDirected,arguments[0]):st(this._isDirected,t,n,r);return Object.hasOwn(this._edgeLabels,o)}removeEdge(t,n,r){var o=arguments.length===1?Pn(this._isDirected,arguments[0]):st(this._isDirected,t,n,r),i=this._edgeObjs[o];return i&&(t=i.v,n=i.w,delete this._edgeLabels[o],delete this._edgeObjs[o],Lo(this._preds[n],t),Lo(this._sucs[t],n),delete this._in[n][o],delete this._out[t][o],this._edgeCount--),this}inEdges(t,n){var r=this._in[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.v===n):o}}outEdges(t,n){var r=this._out[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.w===n):o}}nodeEdges(t,n){var r=this.inEdges(t,n);if(r)return r.concat(this.outEdges(t,n))}};function To(e,t){e[t]?e[t]++:e[t]=1}function Lo(e,t){--e[t]||delete e[t]}function st(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}return o+Ao+i+Ao+(r===void 0?Pg:r)}function Ag(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}var a={v:o,w:i};return r&&(a.name=r),a}function Pn(e,t){return st(e,t.v,t.w,t.name)}var xr=Og,Tg="2.2.4",Lg={Graph:xr,version:Tg},jg=xr,Rg={write:Dg,read:Vg};function Dg(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:zg(e),edges:Bg(e)};return e.graph()!==void 0&&(t.value=structuredClone(e.graph())),t}function zg(e){return e.nodes().map(function(t){var n=e.node(t),r=e.parent(t),o={v:t};return n!==void 0&&(o.value=n),r!==void 0&&(o.parent=r),o})}function Bg(e){return e.edges().map(function(t){var n=e.edge(t),r={v:t.v,w:t.w};return t.name!==void 0&&(r.name=t.name),n!==void 0&&(r.value=n),r})}function Vg(e){var t=new jg(e.options).setGraph(e.value);return e.nodes.forEach(function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),e.edges.forEach(function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}var Hg=Fg;function Fg(e){var t={},n=[],r;function o(i){Object.hasOwn(t,i)||(t[i]=!0,r.push(i),e.successors(i).forEach(o),e.predecessors(i).forEach(o))}return e.nodes().forEach(function(i){r=[],o(i),r.length&&n.push(r)}),n}let Yg=class{constructor(){re(this,"_arr",[]);re(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(t){return t.key})}has(t){return Object.hasOwn(this._keyIndices,t)}priority(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(t,n){var r=this._keyIndices;if(t=String(t),!Object.hasOwn(r,t)){var o=this._arr,i=o.length;return r[t]=i,o.push({key:t,priority:n}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key}decrease(t,n){var r=this._keyIndices[t];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)}_heapify(t){var n=this._arr,r=2*t,o=r+1,i=t;r<n.length&&(i=n[r].priority<n[i].priority?r:i,o<n.length&&(i=n[o].priority<n[i].priority?o:i),i!==t&&(this._swap(t,i),this._heapify(i)))}_decrease(t){for(var n=this._arr,r=n[t].priority,o;t!==0&&(o=t>>1,!(n[o].priority<r));)this._swap(t,o),t=o}_swap(t,n){var r=this._arr,o=this._keyIndices,i=r[t],s=r[n];r[t]=s,r[n]=i,o[s.key]=t,o[i.key]=n}};var Ws=Yg,Xg=Ws,Gs=Gg,Wg=()=>1;function Gg(e,t,n,r){return qg(e,String(t),n||Wg,r||function(o){return e.outEdges(o)})}function qg(e,t,n,r){var o={},i=new Xg,s,a,c=function(l){var u=l.v!==s?l.v:l.w,d=o[u],f=n(l),h=a.distance+f;if(f<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+l+" Weight: "+f);h<d.distance&&(d.distance=h,d.predecessor=s,i.decrease(u,h))};for(e.nodes().forEach(function(l){var u=l===t?0:Number.POSITIVE_INFINITY;o[l]={distance:u},i.add(l,u)});i.size()>0&&(s=i.removeMin(),a=o[s],a.distance!==Number.POSITIVE_INFINITY);)r(s).forEach(c);return o}var Kg=Gs,Ug=Zg;function Zg(e,t,n){return e.nodes().reduce(function(r,o){return r[o]=Kg(e,o,t,n),r},{})}var qs=Qg;function Qg(e){var t=0,n=[],r={},o=[];function i(s){var a=r[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(u){Object.hasOwn(r,u)?r[u].onStack&&(a.lowlink=Math.min(a.lowlink,r[u].index)):(i(u),a.lowlink=Math.min(a.lowlink,r[u].lowlink))}),a.lowlink===a.index){var c=[],l;do l=n.pop(),r[l].onStack=!1,c.push(l);while(s!==l);o.push(c)}}return e.nodes().forEach(function(s){Object.hasOwn(r,s)||i(s)}),o}var Jg=qs,e0=t0;function t0(e){return Jg(e).filter(function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}var n0=o0,r0=()=>1;function o0(e,t,n){return i0(e,t||r0,n||function(r){return e.outEdges(r)})}function i0(e,t,n){var r={},o=e.nodes();return o.forEach(function(i){r[i]={},r[i][i]={distance:0},o.forEach(function(s){i!==s&&(r[i][s]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var a=s.v===i?s.w:s.v,c=t(s);r[i][a]={distance:c,predecessor:i}})}),o.forEach(function(i){var s=r[i];o.forEach(function(a){var c=r[a];o.forEach(function(l){var u=c[i],d=s[l],f=c[l],h=u.distance+d.distance;h<f.distance&&(f.distance=h,f.predecessor=d.predecessor)})})}),r}function Ks(e){var t={},n={},r=[];function o(i){if(Object.hasOwn(n,i))throw new er;Object.hasOwn(t,i)||(n[i]=!0,t[i]=!0,e.predecessors(i).forEach(o),delete n[i],r.push(i))}if(e.sinks().forEach(o),Object.keys(t).length!==e.nodeCount())throw new er;return r}class er extends Error{constructor(){super(...arguments)}}var Us=Ks;Ks.CycleException=er;var jo=Us,s0=a0;function a0(e){try{jo(e)}catch(t){if(t instanceof jo.CycleException)return!1;throw t}return!0}var Zs=c0;function c0(e,t,n){Array.isArray(t)||(t=[t]);var r=e.isDirected()?a=>e.successors(a):a=>e.neighbors(a),o=n==="post"?l0:u0,i=[],s={};return t.forEach(a=>{if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);o(a,r,s,i)}),i}function l0(e,t,n,r){for(var o=[[e,!1]];o.length>0;){var i=o.pop();i[1]?r.push(i[0]):Object.hasOwn(n,i[0])||(n[i[0]]=!0,o.push([i[0],!0]),Qs(t(i[0]),s=>o.push([s,!1])))}}function u0(e,t,n,r){for(var o=[e];o.length>0;){var i=o.pop();Object.hasOwn(n,i)||(n[i]=!0,r.push(i),Qs(t(i),s=>o.push(s)))}}function Qs(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}var d0=Zs,f0=h0;function h0(e,t){return d0(e,t,"post")}var p0=Zs,g0=m0;function m0(e,t){return p0(e,t,"pre")}var y0=xr,w0=Ws,x0=b0;function b0(e,t){var n=new y0,r={},o=new w0,i;function s(c){var l=c.v===i?c.w:c.v,u=o.priority(l);if(u!==void 0){var d=t(c);d<u&&(r[l]=i,o.decrease(l,d))}}if(e.nodeCount()===0)return n;e.nodes().forEach(function(c){o.add(c,Number.POSITIVE_INFINITY),n.setNode(c)}),o.decrease(e.nodes()[0],0);for(var a=!1;o.size()>0;){if(i=o.removeMin(),Object.hasOwn(r,i))n.setEdge(i,r[i]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(i).forEach(s)}return n}var v0={components:Hg,dijkstra:Gs,dijkstraAll:Ug,findCycles:e0,floydWarshall:n0,isAcyclic:s0,postorder:f0,preorder:g0,prim:x0,tarjan:qs,topsort:Us},Ro=Lg,me={Graph:Ro.Graph,json:Rg,alg:v0,version:Ro.version};let E0=class{constructor(){let t={};t._next=t._prev=t,this._sentinel=t}dequeue(){let t=this._sentinel,n=t._prev;if(n!==t)return Do(n),n}enqueue(t){let n=this._sentinel;t._prev&&t._next&&Do(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n}toString(){let t=[],n=this._sentinel,r=n._prev;for(;r!==n;)t.push(JSON.stringify(r,_0)),r=r._prev;return"["+t.join(", ")+"]"}};function Do(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function _0(e,t){if(e!=="_next"&&e!=="_prev")return t}var N0=E0;let S0=me.Graph,C0=N0;var k0=I0;let M0=()=>1;function I0(e,t){if(e.nodeCount()<=1)return[];let n=P0(e,t||M0);return $0(n.graph,n.buckets,n.zeroIdx).flatMap(o=>e.outEdges(o.v,o.w))}function $0(e,t,n){let r=[],o=t[t.length-1],i=t[0],s;for(;e.nodeCount();){for(;s=i.dequeue();)On(e,t,n,s);for(;s=o.dequeue();)On(e,t,n,s);if(e.nodeCount()){for(let a=t.length-2;a>0;--a)if(s=t[a].dequeue(),s){r=r.concat(On(e,t,n,s,!0));break}}}return r}function On(e,t,n,r,o){let i=o?[]:void 0;return e.inEdges(r.v).forEach(s=>{let a=e.edge(s),c=e.node(s.v);o&&i.push({v:s.v,w:s.w}),c.out-=a,tr(t,n,c)}),e.outEdges(r.v).forEach(s=>{let a=e.edge(s),c=s.w,l=e.node(c);l.in-=a,tr(t,n,l)}),e.removeNode(r.v),i}function P0(e,t){let n=new S0,r=0,o=0;e.nodes().forEach(a=>{n.setNode(a,{v:a,in:0,out:0})}),e.edges().forEach(a=>{let c=n.edge(a.v,a.w)||0,l=t(a),u=c+l;n.setEdge(a.v,a.w,u),o=Math.max(o,n.node(a.v).out+=l),r=Math.max(r,n.node(a.w).in+=l)});let i=O0(o+r+3).map(()=>new C0),s=r+1;return n.nodes().forEach(a=>{tr(i,s,n.node(a))}),{graph:n,buckets:i,zeroIdx:s}}function tr(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function O0(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}let Js=me.Graph;var oe={addBorderNode:V0,addDummyNode:ea,applyWithChunking:fn,asNonCompoundGraph:T0,buildLayerMatrix:D0,intersectRect:R0,mapValues:q0,maxRank:na,normalizeRanks:z0,notime:X0,partition:F0,pick:G0,predecessorWeights:j0,range:oa,removeEmptyRanks:B0,simplify:A0,successorWeights:L0,time:Y0,uniqueId:ra,zipObject:br};function ea(e,t,n,r){let o;do o=ra(r);while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}function A0(e){let t=new Js().setGraph(e.graph());return e.nodes().forEach(n=>t.setNode(n,e.node(n))),e.edges().forEach(n=>{let r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t}function T0(e){let t=new Js({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{e.children(n).length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdge(n,e.edge(n))}),t}function L0(e){let t=e.nodes().map(n=>{let r={};return e.outEdges(n).forEach(o=>{r[o.w]=(r[o.w]||0)+e.edge(o).weight}),r});return br(e.nodes(),t)}function j0(e){let t=e.nodes().map(n=>{let r={};return e.inEdges(n).forEach(o=>{r[o.v]=(r[o.v]||0)+e.edge(o).weight}),r});return br(e.nodes(),t)}function R0(e,t){let n=e.x,r=e.y,o=t.x-n,i=t.y-r,s=e.width/2,a=e.height/2;if(!o&&!i)throw new Error("Not possible to find intersection inside of the rectangle");let c,l;return Math.abs(i)*s>Math.abs(o)*a?(i<0&&(a=-a),c=a*o/i,l=a):(o<0&&(s=-s),c=s,l=s*i/o),{x:n+c,y:r+l}}function D0(e){let t=oa(na(e)+1).map(()=>[]);return e.nodes().forEach(n=>{let r=e.node(n),o=r.rank;o!==void 0&&(t[o][r.order]=n)}),t}function z0(e){let t=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MAX_VALUE:o}),n=fn(Math.min,t);e.nodes().forEach(r=>{let o=e.node(r);Object.hasOwn(o,"rank")&&(o.rank-=n)})}function B0(e){let t=e.nodes().map(s=>e.node(s).rank),n=fn(Math.min,t),r=[];e.nodes().forEach(s=>{let a=e.node(s).rank-n;r[a]||(r[a]=[]),r[a].push(s)});let o=0,i=e.graph().nodeRankFactor;Array.from(r).forEach((s,a)=>{s===void 0&&a%i!==0?--o:s!==void 0&&o&&s.forEach(c=>e.node(c).rank+=o)})}function V0(e,t,n,r){let o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=r),ea(e,"border",o,t)}function H0(e,t=ta){const n=[];for(let r=0;r<e.length;r+=t){const o=e.slice(r,r+t);n.push(o)}return n}const ta=65535;function fn(e,t){if(t.length>ta){const n=H0(t);return e.apply(null,n.map(r=>e.apply(null,r)))}else return e.apply(null,t)}function na(e){const n=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MIN_VALUE:o});return fn(Math.max,n)}function F0(e,t){let n={lhs:[],rhs:[]};return e.forEach(r=>{t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function Y0(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function X0(e,t){return t()}let W0=0;function ra(e){var t=++W0;return toString(e)+t}function oa(e,t,n=1){t==null&&(t=e,e=0);let r=i=>i<t;n<0&&(r=i=>t<i);const o=[];for(let i=e;r(i);i+=n)o.push(i);return o}function G0(e,t){const n={};for(const r of t)e[r]!==void 0&&(n[r]=e[r]);return n}function q0(e,t){let n=t;return typeof t=="string"&&(n=r=>r[t]),Object.entries(e).reduce((r,[o,i])=>(r[o]=n(i,o),r),{})}function br(e,t){return e.reduce((n,r,o)=>(n[r]=t[o],n),{})}let K0=k0,U0=oe.uniqueId;var Z0={run:Q0,undo:em};function Q0(e){(e.graph().acyclicer==="greedy"?K0(e,n(e)):J0(e)).forEach(r=>{let o=e.edge(r);e.removeEdge(r),o.forwardName=r.name,o.reversed=!0,e.setEdge(r.w,r.v,o,U0("rev"))});function n(r){return o=>r.edge(o).weight}}function J0(e){let t=[],n={},r={};function o(i){Object.hasOwn(r,i)||(r[i]=!0,n[i]=!0,e.outEdges(i).forEach(s=>{Object.hasOwn(n,s.w)?t.push(s):o(s.w)}),delete n[i])}return e.nodes().forEach(o),t}function em(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}let tm=oe;var nm={run:rm,undo:im};function rm(e){e.graph().dummyChains=[],e.edges().forEach(t=>om(e,t))}function om(e,t){let n=t.v,r=e.node(n).rank,o=t.w,i=e.node(o).rank,s=t.name,a=e.edge(t),c=a.labelRank;if(i===r+1)return;e.removeEdge(t);let l,u,d;for(d=0,++r;r<i;++d,++r)a.points=[],u={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},l=tm.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=a.width,u.height=a.height,u.dummy="edge-label",u.labelpos=a.labelpos),e.setEdge(n,l,{weight:a.weight},s),d===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,o,{weight:a.weight},s)}function im(e){e.graph().dummyChains.forEach(t=>{let n=e.node(t),r=n.edgeLabel,o;for(e.setEdge(n.edgeObj,r);n.dummy;)o=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=o,n=e.node(t)})}const{applyWithChunking:sm}=oe;var hn={longestPath:am,slack:cm};function am(e){var t={};function n(r){var o=e.node(r);if(Object.hasOwn(t,r))return o.rank;t[r]=!0;let i=e.outEdges(r).map(a=>a==null?Number.POSITIVE_INFINITY:n(a.w)-e.edge(a).minlen);var s=sm(Math.min,i);return s===Number.POSITIVE_INFINITY&&(s=0),o.rank=s}e.sources().forEach(n)}function cm(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var lm=me.Graph,Kt=hn.slack,ia=um;function um(e){var t=new lm({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var o,i;dm(t,e)<r;)o=fm(t,e),i=t.hasNode(o.v)?Kt(e,o):-Kt(e,o),hm(t,e,i);return t}function dm(e,t){function n(r){t.nodeEdges(r).forEach(o=>{var i=o.v,s=r===i?o.w:i;!e.hasNode(s)&&!Kt(t,o)&&(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))})}return e.nodes().forEach(n),e.nodeCount()}function fm(e,t){return t.edges().reduce((r,o)=>{let i=Number.POSITIVE_INFINITY;return e.hasNode(o.v)!==e.hasNode(o.w)&&(i=Kt(t,o)),i<r[0]?[i,o]:r},[Number.POSITIVE_INFINITY,null])[1]}function hm(e,t,n){e.nodes().forEach(r=>t.node(r).rank+=n)}var pm=ia,zo=hn.slack,gm=hn.longestPath,mm=me.alg.preorder,ym=me.alg.postorder,wm=oe.simplify,xm=De;De.initLowLimValues=Er;De.initCutValues=vr;De.calcCutValue=sa;De.leaveEdge=ca;De.enterEdge=la;De.exchangeEdges=ua;function De(e){e=wm(e),gm(e);var t=pm(e);Er(t),vr(t,e);for(var n,r;n=ca(t);)r=la(t,e,n),ua(t,e,n,r)}function vr(e,t){var n=ym(e,e.nodes());n=n.slice(0,n.length-1),n.forEach(r=>bm(e,t,r))}function bm(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=sa(e,t,n)}function sa(e,t,n){var r=e.node(n),o=r.parent,i=!0,s=t.edge(n,o),a=0;return s||(i=!1,s=t.edge(o,n)),a=s.weight,t.nodeEdges(n).forEach(c=>{var l=c.v===n,u=l?c.w:c.v;if(u!==o){var d=l===i,f=t.edge(c).weight;if(a+=d?f:-f,Em(e,n,u)){var h=e.edge(n,u).cutvalue;a+=d?-h:h}}}),a}function Er(e,t){arguments.length<2&&(t=e.nodes()[0]),aa(e,{},1,t)}function aa(e,t,n,r,o){var i=n,s=e.node(r);return t[r]=!0,e.neighbors(r).forEach(a=>{Object.hasOwn(t,a)||(n=aa(e,t,n,a,r))}),s.low=i,s.lim=n++,o?s.parent=o:delete s.parent,n}function ca(e){return e.edges().find(t=>e.edge(t).cutvalue<0)}function la(e,t,n){var r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);var i=e.node(r),s=e.node(o),a=i,c=!1;i.lim>s.lim&&(a=s,c=!0);var l=t.edges().filter(u=>c===Bo(e,e.node(u.v),a)&&c!==Bo(e,e.node(u.w),a));return l.reduce((u,d)=>zo(t,d)<zo(t,u)?d:u)}function ua(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),Er(e),vr(e,t),vm(e,t)}function vm(e,t){var n=e.nodes().find(o=>!t.node(o).parent),r=mm(e,n);r=r.slice(1),r.forEach(o=>{var i=e.node(o).parent,s=t.edge(o,i),a=!1;s||(s=t.edge(i,o),a=!0),t.node(o).rank=t.node(i).rank+(a?s.minlen:-s.minlen)})}function Em(e,t,n){return e.hasEdge(t,n)}function Bo(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var _m=hn,da=_m.longestPath,Nm=ia,Sm=xm,Cm=km;function km(e){switch(e.graph().ranker){case"network-simplex":Vo(e);break;case"tight-tree":Im(e);break;case"longest-path":Mm(e);break;default:Vo(e)}}var Mm=da;function Im(e){da(e),Nm(e)}function Vo(e){Sm(e)}var $m=Pm;function Pm(e){let t=Am(e);e.graph().dummyChains.forEach(n=>{let r=e.node(n),o=r.edgeObj,i=Om(e,t,o.v,o.w),s=i.path,a=i.lca,c=0,l=s[c],u=!0;for(;n!==o.w;){if(r=e.node(n),u){for(;(l=s[c])!==a&&e.node(l).maxRank<r.rank;)c++;l===a&&(u=!1)}if(!u){for(;c<s.length-1&&e.node(l=s[c+1]).minRank<=r.rank;)c++;l=s[c]}e.setParent(n,l),n=e.successors(n)[0]}})}function Om(e,t,n,r){let o=[],i=[],s=Math.min(t[n].low,t[r].low),a=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.parent(c),o.push(c);while(c&&(t[c].low>s||a>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)i.push(c);return{path:o.concat(i.reverse()),lca:l}}function Am(e){let t={},n=0;function r(o){let i=n;e.children(o).forEach(r),t[o]={low:i,lim:n++}}return e.children().forEach(r),t}let Ut=oe;var Tm={run:Lm,cleanup:Dm};function Lm(e){let t=Ut.addDummyNode(e,"root",{},"_root"),n=jm(e),r=Object.values(n),o=Ut.applyWithChunking(Math.max,r)-1,i=2*o+1;e.graph().nestingRoot=t,e.edges().forEach(a=>e.edge(a).minlen*=i);let s=Rm(e)+1;e.children().forEach(a=>fa(e,t,i,s,o,n,a)),e.graph().nodeRankFactor=i}function fa(e,t,n,r,o,i,s){let a=e.children(s);if(!a.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:n});return}let c=Ut.addBorderNode(e,"_bt"),l=Ut.addBorderNode(e,"_bb"),u=e.node(s);e.setParent(c,s),u.borderTop=c,e.setParent(l,s),u.borderBottom=l,a.forEach(d=>{fa(e,t,n,r,o,i,d);let f=e.node(d),h=f.borderTop?f.borderTop:d,p=f.borderBottom?f.borderBottom:d,g=f.borderTop?r:2*r,v=h!==p?1:o-i[s]+1;e.setEdge(c,h,{weight:g,minlen:v,nestingEdge:!0}),e.setEdge(p,l,{weight:g,minlen:v,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,c,{weight:0,minlen:o+i[s]})}function jm(e){var t={};function n(r,o){var i=e.children(r);i&&i.length&&i.forEach(s=>n(s,o+1)),t[r]=o}return e.children().forEach(r=>n(r,1)),t}function Rm(e){return e.edges().reduce((t,n)=>t+e.edge(n).weight,0)}function Dm(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}let zm=oe;var Bm=Vm;function Vm(e){function t(n){let r=e.children(n),o=e.node(n);if(r.length&&r.forEach(t),Object.hasOwn(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(let i=o.minRank,s=o.maxRank+1;i<s;++i)Ho(e,"borderLeft","_bl",n,o,i),Ho(e,"borderRight","_br",n,o,i)}}e.children().forEach(t)}function Ho(e,t,n,r,o,i){let s={width:0,height:0,rank:i,borderType:t},a=o[t][i-1],c=zm.addDummyNode(e,"border",s,n);o[t][i]=c,e.setParent(c,r),a&&e.setEdge(a,c,{weight:1})}var Hm={adjust:Fm,undo:Ym};function Fm(e){let t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&ha(e)}function Ym(e){let t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Xm(e),(t==="lr"||t==="rl")&&(Wm(e),ha(e))}function ha(e){e.nodes().forEach(t=>Fo(e.node(t))),e.edges().forEach(t=>Fo(e.edge(t)))}function Fo(e){let t=e.width;e.width=e.height,e.height=t}function Xm(e){e.nodes().forEach(t=>An(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(An),Object.hasOwn(n,"y")&&An(n)})}function An(e){e.y=-e.y}function Wm(e){e.nodes().forEach(t=>Tn(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(Tn),Object.hasOwn(n,"x")&&Tn(n)})}function Tn(e){let t=e.x;e.x=e.y,e.y=t}let Yo=oe;var Gm=qm;function qm(e){let t={},n=e.nodes().filter(c=>!e.children(c).length),r=n.map(c=>e.node(c).rank),o=Yo.applyWithChunking(Math.max,r),i=Yo.range(o+1).map(()=>[]);function s(c){if(t[c])return;t[c]=!0;let l=e.node(c);i[l.rank].push(c),e.successors(c).forEach(s)}return n.sort((c,l)=>e.node(c).rank-e.node(l).rank).forEach(s),i}let Km=oe.zipObject;var Um=Zm;function Zm(e,t){let n=0;for(let r=1;r<t.length;++r)n+=Qm(e,t[r-1],t[r]);return n}function Qm(e,t,n){let r=Km(n,n.map((l,u)=>u)),o=t.flatMap(l=>e.outEdges(l).map(u=>({pos:r[u.w],weight:e.edge(u).weight})).sort((u,d)=>u.pos-d.pos)),i=1;for(;i<n.length;)i<<=1;let s=2*i-1;i-=1;let a=new Array(s).fill(0),c=0;return o.forEach(l=>{let u=l.pos+i;a[u]+=l.weight;let d=0;for(;u>0;)u%2&&(d+=a[u+1]),u=u-1>>1,a[u]+=l.weight;c+=l.weight*d}),c}var Jm=ey;function ey(e,t=[]){return t.map(n=>{let r=e.inEdges(n);if(r.length){let o=r.reduce((i,s)=>{let a=e.edge(s),c=e.node(s.v);return{sum:i.sum+a.weight*c.order,weight:i.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:o.sum/o.weight,weight:o.weight}}else return{v:n}})}let ty=oe;var ny=ry;function ry(e,t){let n={};e.forEach((o,i)=>{let s=n[o.v]={indegree:0,in:[],out:[],vs:[o.v],i};o.barycenter!==void 0&&(s.barycenter=o.barycenter,s.weight=o.weight)}),t.edges().forEach(o=>{let i=n[o.v],s=n[o.w];i!==void 0&&s!==void 0&&(s.indegree++,i.out.push(n[o.w]))});let r=Object.values(n).filter(o=>!o.indegree);return oy(r)}function oy(e){let t=[];function n(o){return i=>{i.merged||(i.barycenter===void 0||o.barycenter===void 0||i.barycenter>=o.barycenter)&&iy(o,i)}}function r(o){return i=>{i.in.push(o),--i.indegree===0&&e.push(i)}}for(;e.length;){let o=e.pop();t.push(o),o.in.reverse().forEach(n(o)),o.out.forEach(r(o))}return t.filter(o=>!o.merged).map(o=>ty.pick(o,["vs","i","barycenter","weight"]))}function iy(e,t){let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}let sy=oe;var ay=cy;function cy(e,t){let n=sy.partition(e,u=>Object.hasOwn(u,"barycenter")),r=n.lhs,o=n.rhs.sort((u,d)=>d.i-u.i),i=[],s=0,a=0,c=0;r.sort(ly(!!t)),c=Xo(i,o,c),r.forEach(u=>{c+=u.vs.length,i.push(u.vs),s+=u.barycenter*u.weight,a+=u.weight,c=Xo(i,o,c)});let l={vs:i.flat(!0)};return a&&(l.barycenter=s/a,l.weight=a),l}function Xo(e,t,n){let r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e.push(r.vs),n++;return n}function ly(e){return(t,n)=>t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}let uy=Jm,dy=ny,fy=ay;var hy=pa;function pa(e,t,n,r){let o=e.children(t),i=e.node(t),s=i?i.borderLeft:void 0,a=i?i.borderRight:void 0,c={};s&&(o=o.filter(f=>f!==s&&f!==a));let l=uy(e,o);l.forEach(f=>{if(e.children(f.v).length){let h=pa(e,f.v,n,r);c[f.v]=h,Object.hasOwn(h,"barycenter")&&gy(f,h)}});let u=dy(l,n);py(u,c);let d=fy(u,r);if(s&&(d.vs=[s,d.vs,a].flat(!0),e.predecessors(s).length)){let f=e.node(e.predecessors(s)[0]),h=e.node(e.predecessors(a)[0]);Object.hasOwn(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+f.order+h.order)/(d.weight+2),d.weight+=2}return d}function py(e,t){e.forEach(n=>{n.vs=n.vs.flatMap(r=>t[r]?t[r].vs:r)})}function gy(e,t){e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}let my=me.Graph,yy=oe;var wy=xy;function xy(e,t,n){let r=by(e),o=new my({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{let s=e.node(i),a=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(o.setNode(i),o.setParent(i,a||r),e[n](i).forEach(c=>{let l=c.v===i?c.w:c.v,u=o.edge(l,i),d=u!==void 0?u.weight:0;o.setEdge(l,i,{weight:e.edge(c).weight+d})}),Object.hasOwn(s,"minRank")&&o.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),o}function by(e){for(var t;e.hasNode(t=yy.uniqueId("_root")););return t}var vy=Ey;function Ey(e,t,n){let r={},o;n.forEach(i=>{let s=e.parent(i),a,c;for(;s;){if(a=e.parent(s),a?(c=r[a],r[a]=s):(c=o,o=s),c&&c!==s){t.setEdge(c,s);return}s=a}})}let _y=Gm,Ny=Um,Sy=hy,Cy=wy,ky=vy,My=me.Graph,Tt=oe;var Iy=ga;function ga(e,t){if(t&&typeof t.customOrder=="function"){t.customOrder(e,ga);return}let n=Tt.maxRank(e),r=Wo(e,Tt.range(1,n+1),"inEdges"),o=Wo(e,Tt.range(n-1,-1,-1),"outEdges"),i=_y(e);if(Go(e,i),t&&t.disableOptimalOrderHeuristic)return;let s=Number.POSITIVE_INFINITY,a;for(let c=0,l=0;l<4;++c,++l){$y(c%2?r:o,c%4>=2),i=Tt.buildLayerMatrix(e);let u=Ny(e,i);u<s&&(l=0,a=Object.assign({},i),s=u)}Go(e,a)}function Wo(e,t,n){return t.map(function(r){return Cy(e,r,n)})}function $y(e,t){let n=new My;e.forEach(function(r){let o=r.graph().root,i=Sy(r,o,n,t);i.vs.forEach((s,a)=>r.node(s).order=a),ky(r,n,i.vs)})}function Go(e,t){Object.values(t).forEach(n=>n.forEach((r,o)=>e.node(r).order=o))}let Py=me.Graph,ve=oe;var Oy={positionX:Ly,findType1Conflicts:ma,findType2Conflicts:ya,addConflict:_r,hasConflict:wa,verticalAlignment:xa,horizontalCompaction:ba,alignCoordinates:Ea,findSmallestWidthAlignment:va,balance:_a};function ma(e,t){let n={};function r(o,i){let s=0,a=0,c=o.length,l=i[i.length-1];return i.forEach((u,d)=>{let f=Ay(e,u),h=f?e.node(f).order:c;(f||u===l)&&(i.slice(a,d+1).forEach(p=>{e.predecessors(p).forEach(g=>{let v=e.node(g),w=v.order;(w<s||h<w)&&!(v.dummy&&e.node(p).dummy)&&_r(n,g,p)})}),a=d+1,s=h)}),i}return t.length&&t.reduce(r),n}function ya(e,t){let n={};function r(i,s,a,c,l){let u;ve.range(s,a).forEach(d=>{u=i[d],e.node(u).dummy&&e.predecessors(u).forEach(f=>{let h=e.node(f);h.dummy&&(h.order<c||h.order>l)&&_r(n,f,u)})})}function o(i,s){let a=-1,c,l=0;return s.forEach((u,d)=>{if(e.node(u).dummy==="border"){let f=e.predecessors(u);f.length&&(c=e.node(f[0]).order,r(s,l,d,a,c),l=d,a=c)}r(s,l,s.length,c,i.length)}),s}return t.length&&t.reduce(o),n}function Ay(e,t){if(e.node(t).dummy)return e.predecessors(t).find(n=>e.node(n).dummy)}function _r(e,t,n){if(t>n){let o=t;t=n,n=o}let r=e[t];r||(e[t]=r={}),r[n]=!0}function wa(e,t,n){if(t>n){let r=t;t=n,n=r}return!!e[t]&&Object.hasOwn(e[t],n)}function xa(e,t,n,r){let o={},i={},s={};return t.forEach(a=>{a.forEach((c,l)=>{o[c]=c,i[c]=c,s[c]=l})}),t.forEach(a=>{let c=-1;a.forEach(l=>{let u=r(l);if(u.length){u=u.sort((f,h)=>s[f]-s[h]);let d=(u.length-1)/2;for(let f=Math.floor(d),h=Math.ceil(d);f<=h;++f){let p=u[f];i[l]===l&&c<s[p]&&!wa(n,l,p)&&(i[p]=l,i[l]=o[l]=o[p],c=s[p])}}})}),{root:o,align:i}}function ba(e,t,n,r,o){let i={},s=Ty(e,t,n,o),a=o?"borderLeft":"borderRight";function c(d,f){let h=s.nodes(),p=h.pop(),g={};for(;p;)g[p]?d(p):(g[p]=!0,h.push(p),h=h.concat(f(p))),p=h.pop()}function l(d){i[d]=s.inEdges(d).reduce((f,h)=>Math.max(f,i[h.v]+s.edge(h)),0)}function u(d){let f=s.outEdges(d).reduce((p,g)=>Math.min(p,i[g.w]-s.edge(g)),Number.POSITIVE_INFINITY),h=e.node(d);f!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(i[d]=Math.max(i[d],f))}return c(l,s.predecessors.bind(s)),c(u,s.successors.bind(s)),Object.keys(r).forEach(d=>i[d]=i[n[d]]),i}function Ty(e,t,n,r){let o=new Py,i=e.graph(),s=jy(i.nodesep,i.edgesep,r);return t.forEach(a=>{let c;a.forEach(l=>{let u=n[l];if(o.setNode(u),c){var d=n[c],f=o.edge(d,u);o.setEdge(d,u,Math.max(s(e,l,c),f||0))}c=l})}),o}function va(e,t){return Object.values(t).reduce((n,r)=>{let o=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;Object.entries(r).forEach(([a,c])=>{let l=Ry(e,a)/2;o=Math.max(c+l,o),i=Math.min(c-l,i)});const s=o-i;return s<n[0]&&(n=[s,r]),n},[Number.POSITIVE_INFINITY,null])[1]}function Ea(e,t){let n=Object.values(t),r=ve.applyWithChunking(Math.min,n),o=ve.applyWithChunking(Math.max,n);["u","d"].forEach(i=>{["l","r"].forEach(s=>{let a=i+s,c=e[a];if(c===t)return;let l=Object.values(c),u=r-ve.applyWithChunking(Math.min,l);s!=="l"&&(u=o-ve.applyWithChunking(Math.max,l)),u&&(e[a]=ve.mapValues(c,d=>d+u))})})}function _a(e,t){return ve.mapValues(e.ul,(n,r)=>{if(t)return e[t.toLowerCase()][r];{let o=Object.values(e).map(i=>i[r]).sort((i,s)=>i-s);return(o[1]+o[2])/2}})}function Ly(e){let t=ve.buildLayerMatrix(e),n=Object.assign(ma(e,t),ya(e,t)),r={},o;["u","d"].forEach(s=>{o=s==="u"?t:Object.values(t).reverse(),["l","r"].forEach(a=>{a==="r"&&(o=o.map(d=>Object.values(d).reverse()));let c=(s==="u"?e.predecessors:e.successors).bind(e),l=xa(e,o,n,c),u=ba(e,o,l.root,l.align,a==="r");a==="r"&&(u=ve.mapValues(u,d=>-d)),r[s+a]=u})});let i=va(e,r);return Ea(r,i),_a(r,e.graph().align)}function jy(e,t,n){return(r,o,i)=>{let s=r.node(o),a=r.node(i),c=0,l;if(c+=s.width/2,Object.hasOwn(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":l=-s.width/2;break;case"r":l=s.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(s.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,Object.hasOwn(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2;break}return l&&(c+=n?l:-l),l=0,c}}function Ry(e,t){return e.node(t).width}let Na=oe,Dy=Oy.positionX;var zy=By;function By(e){e=Na.asNonCompoundGraph(e),Vy(e),Object.entries(Dy(e)).forEach(([t,n])=>e.node(t).x=n)}function Vy(e){let t=Na.buildLayerMatrix(e),n=e.graph().ranksep,r=0;t.forEach(o=>{const i=o.reduce((s,a)=>{const c=e.node(a).height;return s>c?s:c},0);o.forEach(s=>e.node(s).y=r+i/2),r+=i+n})}let qo=Z0,Ko=nm,Hy=Cm,Fy=oe.normalizeRanks,Yy=$m,Xy=oe.removeEmptyRanks,Uo=Tm,Wy=Bm,Zo=Hm,Gy=Iy,qy=zy,ue=oe,Ky=me.Graph;var Uy=Zy;function Zy(e,t){let n=t&&t.debugTiming?ue.time:ue.notime;n("layout",()=>{let r=n("  buildLayoutGraph",()=>aw(e));n("  runLayout",()=>Qy(r,n,t)),n("  updateInputGraph",()=>Jy(e,r))})}function Qy(e,t,n){t("    makeSpaceForEdgeLabels",()=>cw(e)),t("    removeSelfEdges",()=>yw(e)),t("    acyclic",()=>qo.run(e)),t("    nestingGraph.run",()=>Uo.run(e)),t("    rank",()=>Hy(ue.asNonCompoundGraph(e))),t("    injectEdgeLabelProxies",()=>lw(e)),t("    removeEmptyRanks",()=>Xy(e)),t("    nestingGraph.cleanup",()=>Uo.cleanup(e)),t("    normalizeRanks",()=>Fy(e)),t("    assignRankMinMax",()=>uw(e)),t("    removeEdgeLabelProxies",()=>dw(e)),t("    normalize.run",()=>Ko.run(e)),t("    parentDummyChains",()=>Yy(e)),t("    addBorderSegments",()=>Wy(e)),t("    order",()=>Gy(e,n)),t("    insertSelfEdges",()=>ww(e)),t("    adjustCoordinateSystem",()=>Zo.adjust(e)),t("    position",()=>qy(e)),t("    positionSelfEdges",()=>xw(e)),t("    removeBorderNodes",()=>mw(e)),t("    normalize.undo",()=>Ko.undo(e)),t("    fixupEdgeLabelCoords",()=>pw(e)),t("    undoCoordinateSystem",()=>Zo.undo(e)),t("    translateGraph",()=>fw(e)),t("    assignNodeIntersects",()=>hw(e)),t("    reversePoints",()=>gw(e)),t("    acyclic.undo",()=>qo.undo(e))}function Jy(e,t){e.nodes().forEach(n=>{let r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,r.rank=o.rank,t.children(n).length&&(r.width=o.width,r.height=o.height))}),e.edges().forEach(n=>{let r=e.edge(n),o=t.edge(n);r.points=o.points,Object.hasOwn(o,"x")&&(r.x=o.x,r.y=o.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}let ew=["nodesep","edgesep","ranksep","marginx","marginy"],tw={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},nw=["acyclicer","ranker","rankdir","align"],rw=["width","height"],Qo={width:0,height:0},ow=["minlen","weight","width","height","labeloffset"],iw={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},sw=["labelpos"];function aw(e){let t=new Ky({multigraph:!0,compound:!0}),n=jn(e.graph());return t.setGraph(Object.assign({},tw,Ln(n,ew),ue.pick(n,nw))),e.nodes().forEach(r=>{let o=jn(e.node(r));const i=Ln(o,rw);Object.keys(Qo).forEach(s=>{i[s]===void 0&&(i[s]=Qo[s])}),t.setNode(r,i),t.setParent(r,e.parent(r))}),e.edges().forEach(r=>{let o=jn(e.edge(r));t.setEdge(r,Object.assign({},iw,Ln(o,ow),ue.pick(o,sw)))}),t}function cw(e){let t=e.graph();t.ranksep/=2,e.edges().forEach(n=>{let r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function lw(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.width&&n.height){let r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};ue.addDummyNode(e,"edge-proxy",i,"_ep")}})}function uw(e){let t=0;e.nodes().forEach(n=>{let r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))}),e.graph().maxRank=t}function dw(e){e.nodes().forEach(t=>{let n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function fw(e){let t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,o=0,i=e.graph(),s=i.marginx||0,a=i.marginy||0;function c(l){let u=l.x,d=l.y,f=l.width,h=l.height;t=Math.min(t,u-f/2),n=Math.max(n,u+f/2),r=Math.min(r,d-h/2),o=Math.max(o,d+h/2)}e.nodes().forEach(l=>c(e.node(l))),e.edges().forEach(l=>{let u=e.edge(l);Object.hasOwn(u,"x")&&c(u)}),t-=s,r-=a,e.nodes().forEach(l=>{let u=e.node(l);u.x-=t,u.y-=r}),e.edges().forEach(l=>{let u=e.edge(l);u.points.forEach(d=>{d.x-=t,d.y-=r}),Object.hasOwn(u,"x")&&(u.x-=t),Object.hasOwn(u,"y")&&(u.y-=r)}),i.width=n-t+s,i.height=o-r+a}function hw(e){e.edges().forEach(t=>{let n=e.edge(t),r=e.node(t.v),o=e.node(t.w),i,s;n.points?(i=n.points[0],s=n.points[n.points.length-1]):(n.points=[],i=o,s=r),n.points.unshift(ue.intersectRect(r,i)),n.points.push(ue.intersectRect(o,s))})}function pw(e){e.edges().forEach(t=>{let n=e.edge(t);if(Object.hasOwn(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function gw(e){e.edges().forEach(t=>{let n=e.edge(t);n.reversed&&n.points.reverse()})}function mw(e){e.nodes().forEach(t=>{if(e.children(t).length){let n=e.node(t),r=e.node(n.borderTop),o=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),s=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(s.x-i.x),n.height=Math.abs(o.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}}),e.nodes().forEach(t=>{e.node(t).dummy==="border"&&e.removeNode(t)})}function yw(e){e.edges().forEach(t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function ww(e){var t=ue.buildLayerMatrix(e);t.forEach(n=>{var r=0;n.forEach((o,i)=>{var s=e.node(o);s.order=i+r,(s.selfEdges||[]).forEach(a=>{ue.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:i+ ++r,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function xw(e){e.nodes().forEach(t=>{var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,s=n.x-o,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*s/3,y:i-a},{x:o+5*s/6,y:i-a},{x:o+s,y:i},{x:o+5*s/6,y:i+a},{x:o+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}function Ln(e,t){return ue.mapValues(ue.pick(e,t),Number)}function jn(e){var t={};return e&&Object.entries(e).forEach(([n,r])=>{typeof n=="string"&&(n=n.toLowerCase()),t[n]=r}),t}let bw=oe,vw=me.Graph;var Ew={debugOrdering:_w};function _w(e){let t=bw.buildLayerMatrix(e),n=new vw({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach(r=>{n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),e.edges().forEach(r=>n.setEdge(r.v,r.w,{},r.name)),t.forEach((r,o)=>{let i="layer"+o;n.setNode(i,{rank:"same"}),r.reduce((s,a)=>(n.setEdge(s,a,{style:"invis"}),a))}),n}var Nw="1.1.4",Sw={graphlib:me,layout:Uy,debug:Ew,util:{time:oe.time,notime:oe.notime},version:Nw};const Jo=ri(Sw),Cw=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsxs("g",{fill:"none","fill-rule":"evenodd",children:[b.jsx("path",{fill:"#9AA7B0","fill-opacity":".9",d:"M7.9844,4 L6.6964,2.711 C6.3044,2.32 5.5324,2 4.9784,2 L1.0504,2 C1.0234,2 1.0004,2.022 1.0004,2.051 L1.0004,13 L8,13 L8,8 L15.0004,8 L15.0004,4 L7.9844,4 Z"}),b.jsx("polygon",{fill:"#40B6E0",points:"13 16 16 16 16 13 13 13"}),b.jsx("polygon",{fill:"#40B6E0",points:"13 12 16 12 16 9 13 9"}),b.jsx("polygon",{fill:"#40B6E0",points:"9 16 12 16 12 13 9 13"}),b.jsx("polygon",{fill:"#40B6E0",points:"9 12 12 12 12 9 9 9"})]})}),kw=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsxs("g",{fill:"none","fill-opacity":".9","fill-rule":"evenodd",children:[b.jsx("polygon",{fill:"#40B6E0",points:"2 14 11 14 11 5 2 5"}),b.jsx("polygon",{fill:"#40B6E0",points:"11.3 4 2 4 4 2 13.3 2"}),b.jsx("polygon",{fill:"#40B6E0",points:"14 2.8 14 12 12 14 12 4.8"})]})}),Mw=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none","fill-rule":"evenodd",children:b.jsx("polygon",{fill:"#40B6E0","fill-opacity":".9",points:"7 16 10 10 2.5 10 10 1 8.5 7 14.5 7"})})}),Iw=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none","fill-rule":"evenodd",transform:"translate(-4,-4) scale(1.5)",children:b.jsx("path",{fill:"#40B6E0","fill-opacity":".9",d:"M1,8 L2,8 L2,4 L3.5,4 L3.5,3 L2,3 C1.99687783,2.36169171 1.99509925,2.02835838 1.99466424,2 C1.98704681,1.50341351 2.13289549,1.0728225 2.43221029,0.972167969 C2.91964141,0.808253079 3.56884985,1.02114795 3.68984985,1.06414795 L3.98519897,0.226043701 C3.90948298,0.198825534 3.4559021,0 2.81140137,0 C2.16690063,1.40512602e-16 1.81677246,0.0614013672 1.4818929,0.388793945 C1.16513106,0.698473875 1.01614114,1.22015248 1.00124609,2 C1.00039414,2.04460465 0.999980878,2.95274463 1,3 C1.00000736,3.01819872 0.666674031,3.01819872 0,3 L0,3.972 L1,3.972 L1,8 Z",transform:"translate(6 4)"})})}),$w=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none","fill-rule":"evenodd",transform:"translate(-4,-4) scale(1.5)",children:b.jsx("polygon",{fill:"#40B6E0","fill-opacity":".9",points:"8.5 10 8.5 6 9.5 5.664 9.5 5 6.5 5 6.5 5.664 7.5 6 7.5 10 6.5 10.344 6.5 11 9.5 11 9.5 10.344"})})}),Pw=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none","fill-rule":"evenodd",transform:"translate(-4,-4) scale(1.5)",children:b.jsx("path",{fill:"#40B6E0","fill-opacity":".9",d:"M3.15333333,6 C2.26166667,6 1.42,5.69166667 0.72,5.06666667 L1.33666667,4.33333333 C1.895,4.81666667 2.46166667,5.09166667 3.17833333,5.09166667 C3.81166667,5.09166667 4.21166667,4.79166667 4.21166667,4.35833333 L4.21166667,4.34166667 C4.21166667,3.925 3.97833333,3.7 2.895,3.45 C1.65333333,3.15 0.953333333,2.78333333 0.953333333,1.70833333 L0.953333333,1.69166667 C0.953333333,0.691666667 1.78666667,2.48689958e-14 2.945,2.48689958e-14 C3.795,2.48689958e-14 4.47,0.258333333 5.06166667,0.733333333 L4.51166667,1.50833333 C3.98666667,1.11666667 3.46166667,0.908333333 2.92833333,0.908333333 C2.32833333,0.908333333 1.97833333,1.21666667 1.97833333,1.6 L1.97833333,1.61666667 C1.97833333,2.06666667 2.245,2.26666667 3.37,2.53333333 C4.60333333,2.83333333 5.23666667,3.275 5.23666667,4.24166667 L5.23666667,4.25833333 C5.23666667,5.35 4.37833333,6 3.15333333,6 Z",transform:"translate(5 5)"})})}),Ow=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsxs("g",{fill:"none","fill-opacity":".9","fill-rule":"evenodd",children:[b.jsx("polygon",{fill:"white",points:"7 1 3 5 7 5"}),b.jsx("path",{fill:"white",d:"M5,9 L11,9 L11,7 L5,7 L5,9 Z M5,13 L11,13 L11,10 L5,10 L5,13 Z M8,1 L8,6 L3,6 L3,15 L13,15 L13,1 L8,1 Z"})]})}),ei={ConceptType:b.jsx(Cw,{}),EntityType:b.jsx(kw,{}),EventType:b.jsx(Mw,{}),Float:b.jsx(Iw,{}),Integer:b.jsx($w,{}),String:b.jsx(Pw,{})},Aw=M.memo(e=>{const{entity:t={}}=e.data,n=(t.types||[]).filter(r=>Object.keys(ei).includes(r));return b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"clouds",children:n.map((r,o)=>b.jsx("div",{className:"cloud gradient",children:b.jsx("div",{children:ei[r]})},o))}),b.jsx("div",{className:"wrapper gradient",children:b.jsxs("div",{className:"inner",children:[b.jsxs("div",{className:"body",children:[b.jsx("div",{className:"icon",children:b.jsx(Ow,{})}),b.jsxs("div",{children:[b.jsx("div",{className:"title",children:t.name}),b.jsx("div",{className:"subtitle",children:t.aliasName})]})]}),b.jsx(Ue,{type:"target",position:F.Left}),b.jsx(Ue,{type:"source",position:F.Right})]})})]})}),Tw=e=>{const{id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s,targetPosition:a,style:c={},markerEnd:l}=e,u=n===o,d=r===i,[f]=dr({sourceX:u?n+1e-4:n,sourceY:d?r+1e-4:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a});return b.jsx(b.Fragment,{children:b.jsx("path",{id:t,style:c,className:"react-flow__edge-path",d:f,markerEnd:l})})};const ti=(e,t,n="TB")=>{const r=n==="LR",o=new Jo.graphlib.Graph().setDefaultEdgeLabel(()=>({}));o.setGraph({rankdir:n}),e.forEach(c=>{o.setNode(c.id,{width:(c.data.width||150)+32,height:c.data.height||20})}),t.forEach(c=>o.setEdge(c.source,c.target));const i=3,s=[],a=()=>{for(let c=0;c<s.length-1;c+=1)o.setEdge(s[c].id,s[c+1].id);s.splice(0,s.length)};return e.forEach(c=>{t.find(l=>l.source===c.id||l.target===c.id)?a():(s.push(c),s.length>=i&&a())}),a(),Jo.layout(o),e.map(c=>{const l=o.node(c.id);return{...c,targetPosition:r?"left":"top",sourcePosition:r?"right":"bottom",position:{x:l.x,y:l.y}}})},Lw=e=>{const{initialEntities:t=[]}=e,[n,r,o]=sg([]),[i,s,a]=ag([]);return M.useEffect(()=>{const c=[],l=[],u=[];t.forEach(d=>{const{id:f=""}=d;if(!c.find(h=>h.id===f)){const h={id:f,position:{x:0,y:0},type:"turbo",data:{entity:d}},p=n.find(g=>g.id===f);p&&(h.position=p.position,h.data.width=p.data.width,h.data.height=p.data.height),c.push(h)}}),t.forEach(d=>{const{id:f="",types:h=[]}=d;h.forEach(p=>{const g=t.find(v=>v.name==p);g&&l.push({id:`edge__${g.id}__${f}`,source:`${g.id}`,target:f})})}),r(ti(c,l,"LR")),s([...l,...u])},[t]),M.useEffect(()=>{let c=!1;const l=n.map(u=>u.measured&&(u.measured.width!=u.data.width||u.measured.height!=u.data.height)?(c=!0,{...u,data:{...u.data,width:u.measured.width,height:u.measured.height}}):u);c&&r(ti(l,i,"LR"))},[n]),b.jsx("div",{className:"schema-diagram",children:b.jsx("div",{className:"turbo-container",children:b.jsxs(ig,{nodes:n,edges:i,onNodesChange:o,onEdgesChange:a,connectionLineType:be.SmoothStep,fitView:!0,nodeTypes:{turbo:Aw},edgeTypes:{turbo:Tw},defaultEdgeOptions:{type:"turbo",markerEnd:"edge-circle"},children:[b.jsx(wg,{showInteractive:!1,position:"top-left"}),b.jsx("svg",{children:b.jsxs("defs",{children:[b.jsxs("linearGradient",{id:"edge-gradient",children:[b.jsx("stop",{offset:"0%",stopColor:"#ae53ba"}),b.jsx("stop",{offset:"100%",stopColor:"#2a8af6"})]}),b.jsx("marker",{id:"edge-circle",viewBox:"-5 -5 10 10",refX:"0",refY:"0",markerUnits:"strokeWidth",markerWidth:"10",markerHeight:"10",orient:"auto",children:b.jsx("circle",{stroke:"#2a8af6",strokeOpacity:"0.75",r:"2",cx:"0",cy:"0"})})]})})]})})})},jw="/openspg/api",nr=({name:e,aliasName:t,types:n,properties:r},o,i="")=>{const s={id:`${i}${o}`,name:e,aliasName:t,types:n};return r==null||r.forEach(({name:a,value:c,children:l=[]})=>{a==="desc"&&c?s.desc=c.trim():a==="index"&&c?s.index=c.trim():a==="hypernymPredicate"&&c?s.hypernymPredicate=c.trim():a==="regular"&&c?s.regular=c.trim():a==="spreadable"&&typeof c<"u"?s.spreadable=c.trim():a==="autoRelate"&&c?s.autoRelate=c.trim():a==="properties"&&(l==null?void 0:l.length)>0?s.properties=l.map((u,d)=>nr(u,d,`${s.id}_`)):a==="relations"&&(l==null?void 0:l.length)>0&&(s.relations=l.map((u,d)=>nr(u,d,`${s.id}_`)))}),s},Rw=async()=>{const t=await(await fetch(`${jw}/schema/fetch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json(),{namespace:n={},entities:r=[]}=t.data;return Promise.resolve({namespace:{value:n.value},entities:r.map((o,i)=>nr(o,i)).filter(o=>o)})},Dw={requestSchema:Rw},zw={"diagram-container":"_diagram-container_1ph5e_1"};function Bw(e,t,n){var r=this,o=M.useRef(null),i=M.useRef(0),s=M.useRef(null),a=M.useRef([]),c=M.useRef(),l=M.useRef(),u=M.useRef(e),d=M.useRef(!0);M.useEffect(function(){u.current=e},[e]);var f=!t&&t!==0&&typeof window<"u";if(typeof e!="function")throw new TypeError("Expected a function");t=+t||0;var h=!!(n=n||{}).leading,p=!("trailing"in n)||!!n.trailing,g="maxWait"in n,v=g?Math.max(+n.maxWait||0,t):null;M.useEffect(function(){return d.current=!0,function(){d.current=!1}},[]);var w=M.useMemo(function(){var _=function(A){var P=a.current,O=c.current;return a.current=c.current=null,i.current=A,l.current=u.current.apply(O,P)},x=function(A,P){f&&cancelAnimationFrame(s.current),s.current=f?requestAnimationFrame(A):setTimeout(A,P)},y=function(A){if(!d.current)return!1;var P=A-o.current;return!o.current||P>=t||P<0||g&&A-i.current>=v},S=function(A){return s.current=null,p&&a.current?_(A):(a.current=c.current=null,l.current)},T=function A(){var P=Date.now();if(y(P))return S(P);if(d.current){var O=t-(P-o.current),D=g?Math.min(O,v-(P-i.current)):O;x(A,D)}},N=function(){var A=Date.now(),P=y(A);if(a.current=[].slice.call(arguments),c.current=r,o.current=A,P){if(!s.current&&d.current)return i.current=o.current,x(T,t),h?_(o.current):l.current;if(g)return x(T,t),_(o.current)}return s.current||x(T,t),l.current};return N.cancel=function(){s.current&&(f?cancelAnimationFrame(s.current):clearTimeout(s.current)),i.current=0,a.current=o.current=c.current=s.current=null},N.isPending=function(){return!!s.current},N.flush=function(){return s.current?S(Date.now()):l.current},N},[h,g,t,v,p,f]);return w}function Vw(e,t){return e===t}function ni(e){return typeof e=="function"?function(){return e}:e}function Hw(e,t,n){var r,o,i=n&&n.equalityFn||Vw,s=(r=M.useState(ni(e)),o=r[1],[r[0],M.useCallback(function(d){return o(ni(d))},[])]),a=s[0],c=s[1],l=Bw(M.useCallback(function(d){return c(d)},[c]),t,n),u=M.useRef(e);return i(u.current,e)||(l(e),u.current=e),[a,l]}const qw=()=>{const[e,t]=M.useState(""),[n,r]=M.useState([]),[o,i]=M.useState(0),[s]=Hw(o,300),a=()=>{Dw.requestSchema().then(({namespace:c={},entities:l=[]})=>{t(c.value||""),r([...l])})};return M.useEffect(()=>{console.log(s),a()},[s]),M.useEffect(()=>{a()},[]),b.jsxs(b.Fragment,{children:[b.jsx("div",{style:{display:"none"},"aria-label":"toolbar for interactive",children:b.jsx("a",{id:"schema-diagram-refresh-button",onClick:()=>i(new Date().getTime()),children:"refresh schema"})}),b.jsx("div",{className:zw.diagramContainer,children:b.jsx(Lw,{initialEntities:n})})]})};export{qw as default};
